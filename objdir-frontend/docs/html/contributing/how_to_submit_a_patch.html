

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to submit a patch &mdash; Firefox Source Docs  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/firefox.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.4/mermaid.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Firefox Source Docs
          

          
            
            <img src="../_static/firefox-wordmark.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Getting Set Up To Work On The Firefox Codebase</a></li>
</ul>
<p class="caption"><span class="caption-text">Working On Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Working on Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bug-mgmt/index.html">Bug Handling</a></li>
</ul>
<p class="caption"><span class="caption-text">Source Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../browser/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dom/index.html">DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../layout/index.html">Layout &amp; CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gfx/index.html">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devtools/index.html">Firefox DevTools Contributor Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toolkit/index.html">Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../js/index.html">SpiderMonkey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mobile/android/geckoview/index.html">Welcome to GeckoView’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dom/bindings/webidl/index.html">WebIDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/libpref/index.html">libpref</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remote/index.html">Remote Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/common/services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uriloader/index.html">File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../widget/cocoa/index.html">Firefox on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code-quality/index.html">Code quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writing-rust-code/index.html">Writing Rust Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/profiler/index.html">Gecko Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">The Firefox Build System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mach/index.html">Mach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/try/index.html">Try Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build/buildsystem/index.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../taskcluster/index.html">TaskCluster Task-Graph Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/moztreedocs/index.html">Managing Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Testing &amp; Test Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/testing-policy/index.html">Testing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/marionette/index.html">Marionette</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/geckodriver/index.html">geckodriver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web-platform/index.html">web-platform-tests documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/fuzzing/index.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/sanitizer/index.html">Sanitizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/perfdocs/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/code-coverage/index.html">Code coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing-rust-code/index.html">Testing &amp; Debugging Rust Code</a></li>
</ul>
<p class="caption"><span class="caption-text">Localization &amp; Internationalization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intl/index.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../l10n/index.html">Localization</a></li>
</ul>
<p class="caption"><span class="caption-text">Firefox and Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mozbase/index.html">mozbase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Using third-party Python packages</a></li>
</ul>
<p class="caption"><span class="caption-text">Metrics Collected in Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../metrics/index.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/index.html#pings">Pings</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Firefox Source Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>How to submit a patch</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/contributing/how_to_submit_a_patch.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="how-to-submit-a-patch">
<h1>How to submit a patch<a class="headerlink" href="#how-to-submit-a-patch" title="Permalink to this headline">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>This page is an import from MDN and the contents might be outdated</p></td>
</tr>
</tbody>
</table>
<p>Submitting a patch, getting it reviewed, and committed to the Firefox
source tree involves several steps. This article explains how.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We are also providing a <a class="reference internal" href="contribution_quickref.html#firefox-contributors-quick-reference"><span class="std std-ref">Firefox Contributors Quick Reference</span></a> for contributors.</p>
</div>
<p>The process of submission is illustrated by the following diagram, and
each step is detailed below:</p>
<script>mermaid.initialize({startOnLoad:true});</script><div class="mermaid">
            graph TD;
    Preparation --&gt; c[Working on a patch];
    c[Working on a patch] --&gt; Testing;
    Testing --&gt; c[Working on a patch];
    Testing --&gt; e[Submit the patch];
    e[Submit the patch] --&gt; d[Getting Reviews]
    d[Getting Reviews] -- Addressing Review comment --&gt; c[Working on a patch];
    d[Getting Reviews] --&gt; h[Push the change];
        </div><div class="section" id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Permalink to this headline">¶</a></h2>
<p>Every change to the code is tracked by a bug report
in <a class="reference external" href="https://bugzilla.mozilla.org/">bugzilla.mozilla.org</a>. Without a
bug, code will not be reviewed, and without review, code will not be
accepted. To avoid duplication, <a class="reference external" href="https://bugzilla.mozilla.org/query.cgi?format=specific">search for an existing
bug</a> about
your change, and only if none exists, file a new one. Most communication
about code changes take place in the associated code
review, so be sure the bug describes the exact problem being solved.</p>
<p>Please verify the bug is for the correct product and component. For more
information, ask questions on the newsgroups, or on the #developers room
on <a class="reference external" href="https://chat.mozilla.org">chat.mozilla.org</a>.</p>
<p>The person working on a bug should be the ‘assignee’ of that bug in
Bugzilla. If somebody else is currently the assignee of a bug, email
this person to coordinate changes. If the bug is unassigned, leave a
message in the bug’s comments, stating that you intend working on it,
and suggest that someone with bug-editing privileges assign it to you.</p>
<p>Some teams wait for new contributors to attach their first patch before
assigning a bug. This makes it available for other contributors, in case
the new contributor is unable to level up to patch creation. By
expressing interest in a bug comment, someone from that team should
guide you through their process.</p>
</div>
<div class="section" id="module-ownership">
<h2>Module ownership<a class="headerlink" href="#module-ownership" title="Permalink to this headline">¶</a></h2>
<p>All code is supervised by a <a class="reference external" href="https://www.mozilla.org/en-US/about/governance/policies/module-ownership/">module
owner</a>.
This person will be responsible for reviewing and accepting the change.
Before writing your code, determine the module owner, verifying your
proposed change is considered acceptable. They may want to look over any
new user interface (UI review), functions (API review), or testcases for
the proposed change.</p>
<p>If module ownership is not clear, ask on the newsgroups or <a class="reference external" href="https://chat.mozilla.org">on
Matrix</a>. The revision log for the relevant
file might also be helpful. For example, see the change log for {{
Source(“browser/base/content/browser.js”) }}, by clicking the “Hg Log”
link at the top of <a class="reference external" href="https://searchfox.org/mozilla-central/source/">Searchfox</a>, or
by running <code class="docutils literal notranslate"><span class="pre">hg</span> <span class="pre">log</span> <span class="pre">browser/base/content/browser.js</span></code>. The corresponding
checkin message will contain something like “r=nickname”, identifying
active code submissions, and potential code reviewers.</p>
</div>
<div class="section" id="working-on-a-patch">
<h2>Working on a patch<a class="headerlink" href="#working-on-a-patch" title="Permalink to this headline">¶</a></h2>
<p>Changes to the Firefox source code are presented in the form of a patch.
A patch is a commit to version control. Firefox and related code is
stored in our <a class="reference external" href="https://hg.mozilla.org/mozilla-central">Mercurial
server</a>. We have extensive
documentation on using Mercurial in our guide, <a class="reference internal" href="vcs/mercurial.html#mercurial-overview"><span class="std std-ref">Mercurial Overview</span></a>.</p>
<p>Each patch should represent a single complete change, separating
distinct changes into multiple individual patches. If your change
results in a large, complex patch, seek if it can be broken into
<a class="reference external" href="https://secure.phabricator.com/book/phabflavor/article/writing_reviewable_code/#many-small-commits">smaller, easy to understand patches representing complete
steps</a>,
applied on top of each other. This makes it easier to review your
changes, <a class="reference external" href="https://groups.google.com/group/mozilla.dev.planning/msg/2f99460f57f776ef?hl=en">leading to quicker
reviews,</a>
and improved confidence in this review outcome.</p>
<p>Also ensure that your commit message is formatted appropriately. A
simple commit message should look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Bug</span> <span class="mi">123456</span> <span class="o">-</span> <span class="n">Change</span> <span class="n">this</span> <span class="n">thing</span> <span class="n">to</span> <span class="n">work</span> <span class="n">better</span> <span class="n">by</span> <span class="n">doing</span> <span class="n">something</span><span class="o">.</span> <span class="n">r</span><span class="o">=</span><span class="n">reviewers</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">r=reviewers</span></code> part is optional; if you are using Phabricator,
Lando will add it automatically based on who actually granted review,
and in any case the person who does the final check-in of the patch will
make sure it’s added.</p>
<p>The text of the message should be what you did to fix the bug, not a
description of what the bug was. If it is not obvious why this change is
appropriate, then <a class="reference external" href="https://mozilla-version-control-tools.readthedocs.io/en/latest/mozreview/commits.html#write-detailed-commit-messages">explain why in the commit
message</a>.
If this does not fit on one line, then leave a blank line and add
further lines for more detail and/or reasoning.</p>
<p>You can edit the message of the current commit at any time using
<code class="docutils literal notranslate"><span class="pre">hg</span> <span class="pre">commit</span> <span class="pre">--amend</span></code> or <code class="docutils literal notranslate"><span class="pre">hg</span> <span class="pre">histedit</span></code>.</p>
<p>Also look at our <a class="reference internal" href="reviewer_checklist.html#reviewer-checklist"><span class="std std-ref">Reviewer Checklist</span></a> for a list
of best practices for patch content that reviewers will check for or
require.</p>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>All changes must be tested. In most cases, an <a class="reference external" href="https://developer.mozilla.org/docs/Mozilla/QA/Automated_testing">automated
test</a> is required for every
change to the code.</p>
<p>While we desire to have automated tests for all code, we also have a
linter tool which runs static analysis on our JavaScript, for best
practices and common mistakes. See <a class="reference internal" href="../code-quality/lint/linters/eslint.html#eslint"><span class="std std-ref">ESLint</span></a> for more information.</p>
<p>Ensure that your change has not caused regressions, by running the
automated test suite locally, or using the <a class="reference external" href="https://wiki.mozilla.org/Build:TryServer">Mozilla try
server</a>. Module owners, or
developers <a class="reference external" href="https://chat.mozilla.org">on Matrix</a> may be willing to
submit jobs for those currently without try server privileges.</p>
</div>
<div class="section" id="submit-the-patch">
<h2>Submit the patch<a class="headerlink" href="#submit-the-patch" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure you rebase your patch on top of the latest build before you
submit to prevent any merge conflicts.</p>
</div>
<p>Mozilla uses Phabricator for code review. See the <a class="reference external" href="https://moz-conduit.readthedocs.io/en/latest/phabricator-user.html">Mozilla Phabricator
User
Guide</a>
for instructions.</p>
<p>Don’t be shy in posting partial patches, demonstrating potential
approaches, and asking for preliminary feedback. It is easier for others
to comment, and offer suggestions, when a question is accompanied by
some code.</p>
</div>
<div class="section" id="getting-reviews">
<h2>Getting reviews<a class="headerlink" href="#getting-reviews" title="Permalink to this headline">¶</a></h2>
<p>Thorough code reviews are one of Mozilla’s ways of ensuring code
quality. Every patch must be reviewed by the module owner of the code,
or one of their designated peers.</p>
<p>For more information about the review process, see the <a class="reference internal" href="Code_Review_FAQ.html#code-review-faq"><span class="std std-ref">Code Review FAQ</span></a>.</p>
<p>To request a review, you will need to specify one or more usernames
either when you submit the patch, or afterward in the UI. See the
<a class="reference external" href="https://moz-conduit.readthedocs.io/en/latest/phabricator-user.html">Mozilla Phabricator User
Guide</a>
for details.</p>
<p><em>Getting attention:</em> If a reviewer doesn’t respond within a week, or so,
of the review request:</p>
<ul class="simple">
<li><p>Join #developers on Mozilla’s <a class="reference external" href="https://chat.mozilla.org">Matrix
server</a>, and ask if anyone knows why a
review may be delayed. Please link to the bug too.</p></li>
<li><p>If the review is still not addressed, mail the reviewer directly,
asking if/when they’ll have time to review the patch, or might
otherwise be able to review it.</p></li>
<li><p>As a last resort, ask in the appropriate newsgroup on
<code class="docutils literal notranslate"><span class="pre">news.mozilla.org</span></code>.</p></li>
</ul>
</div>
<div class="section" id="addressing-review-comments">
<h2>Addressing review comments<a class="headerlink" href="#addressing-review-comments" title="Permalink to this headline">¶</a></h2>
<p>It is unusual for patches to be perfect the first time around. The
reviewer may use the ‘Request Changes’
<a class="reference external" href="http://moz-conduit.readthedocs.io/en/latest/phabricator-user.html#reviewing-patches">action</a>
and list problems that must be addressed before the patch can be
accepted. Please remember that requesting revisions is not meant to
discourage participation, but rather to encourage the best possible
resolution of a bug. Carefully work through the changes that the
reviewer recommends, attach a new patch, and request review again.</p>
<p>Sometimes a reviewer will grant conditional review with the ‘Accept
Revision’ action but will also indicate minor necessary changes, such as
spelling, or indentation fixes. All recommended corrections should be
made, but a re-review is unnecessary. Make the changes and submit a new
patch. If there is any confusion about the revisions, another review
should be requested.</p>
<p>Sometimes, after a patch is reviewed, but before it can be committed,
someone else makes a conflicting change. If the merge is simple, and
non-invasive, post an updated version of the patch. For all non-trivial
changes, another review is necessary.</p>
<p>If at any point the review process stalls for more than two weeks, see
the previous ‘Getting attention’ section.</p>
<p>In many open source projects, developers will accept patches in an
unfinished state, finish them, and apply the completed code. In
Mozilla’s culture, <strong>the reviewer will only review and comment on a
patch</strong>. If a submitter declines to make the revisions, the patch will
sit idle, until someone chooses to take it on.</p>
</div>
<div class="section" id="pushing-the-change">
<h2>Pushing the change<a class="headerlink" href="#pushing-the-change" title="Permalink to this headline">¶</a></h2>
<p>A patch can be pushed (aka. ‘landed’) after it has been properly
reviewed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note: Be sure to build the application with the patch applied. This
ensures it runs as expected, passing automated tests, and/or runs
through the <a class="reference external" href="https://wiki.mozilla.org/Build:TryServerAsBranch">try
server</a>. In the
bug, please also mention you have completed this step.</p>
<p>Submitting untested patches wastes the committer’s time, and may burn
the release tree. Please save everyone’s time and effort by
completing all necessary verifications.</p>
</div>
<p>Add the tag “check-in needed” on the revision(s) in phabricator. To do
so, click on the “Edit” button on a phabricator revision, and start
typing “check-in needed” in the Tags field. It should auto-complete. If
Phabricator doesn’t allow you to add the keyword, ask someone else to
add it. Community members with commit access, regularly search for
revisions with the checkin-needed keyword, often committing in a day or
so. If the patch does not get checked, within a reasonable timeframe,
join #developers on <a class="reference external" href="https://chat.mozilla.org">chat.mozilla.org</a>, asking
someone to check on your behalf. In most circumstances, a link to a
passing Try run will be required, in order to verify the patch will not
cause any new failures after landing.</p>
<p>If pushing the patch yourself, please follow <a class="reference internal" href="committing_rules_and_responsibilities.html#committing-rules-and-responsibilities"><span class="std std-ref">Committing rules and responsibilities</span></a>.
<a class="reference external" href="https://moz-conduit.readthedocs.io/en/latest/lando-user.html">Lando</a> is used
to automatically land your code.</p>
</div>
<div class="section" id="regressions">
<h2>Regressions<a class="headerlink" href="#regressions" title="Permalink to this headline">¶</a></h2>
<p>It is possible your code causes functional or performance regressions.
There is a tight
<a class="reference external" href="https://www.mozilla.org/about/governance/policies/regressions/">policy</a> on
performance regressions, in particular. This means your code may be
dropped, leaving you to fix and resubmit it. Regressions, ultimately
mean the tests you ran before checking in are not comprehensive enough.
A resubmitted patch, or a patch to fix the regression, should be
accompanied by appropriate tests.</p>
<p>After authoring a few patches, consider <a class="reference external" href="https://www.mozilla.org/about/governance/policies/commit/">getting commit access to
Mozilla source code</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>