

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Committing rules and responsibilities &mdash; Firefox Source Docs  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/firefox.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Firefox Source Docs
          

          
            
            <img src="../_static/firefox-wordmark.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Getting Set Up To Work On The Firefox Codebase</a></li>
</ul>
<p class="caption"><span class="caption-text">Working On Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Working on Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bug-mgmt/index.html">Bug Handling</a></li>
</ul>
<p class="caption"><span class="caption-text">Source Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../browser/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dom/index.html">DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../layout/index.html">Layout &amp; CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gfx/index.html">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devtools/index.html">Firefox DevTools Contributor Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toolkit/index.html">Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../js/index.html">SpiderMonkey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mobile/android/geckoview/index.html">Welcome to GeckoView’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dom/bindings/webidl/index.html">WebIDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/libpref/index.html">libpref</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remote/index.html">Remote Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/common/services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uriloader/index.html">File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../widget/cocoa/index.html">Firefox on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code-quality/index.html">Code quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writing-rust-code/index.html">Writing Rust Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/profiler/index.html">Gecko Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">The Firefox Build System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mach/index.html">Mach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/try/index.html">Try Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build/buildsystem/index.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../taskcluster/index.html">TaskCluster Task-Graph Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/moztreedocs/index.html">Managing Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Testing &amp; Test Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/testing-policy/index.html">Testing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/marionette/index.html">Marionette</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/geckodriver/index.html">geckodriver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web-platform/index.html">web-platform-tests documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/fuzzing/index.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/sanitizer/index.html">Sanitizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/perfdocs/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/code-coverage/index.html">Code coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing-rust-code/index.html">Testing &amp; Debugging Rust Code</a></li>
</ul>
<p class="caption"><span class="caption-text">Localization &amp; Internationalization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intl/index.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../l10n/index.html">Localization</a></li>
</ul>
<p class="caption"><span class="caption-text">Firefox and Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mozbase/index.html">mozbase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Using third-party Python packages</a></li>
</ul>
<p class="caption"><span class="caption-text">Metrics Collected in Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../metrics/index.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/index.html#pings">Pings</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Firefox Source Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Committing rules and responsibilities</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/contributing/committing_rules_and_responsibilities.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="committing-rules-and-responsibilities">
<h1>Committing rules and responsibilities<a class="headerlink" href="#committing-rules-and-responsibilities" title="Permalink to this headline">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>This page is an import from MDN and the contents might be outdated</p></td>
</tr>
</tbody>
</table>
<div class="section" id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Permalink to this headline">¶</a></h2>
<p>There are things you need to be sure of before you even attempt to check
in:</p>
<ul class="simple">
<li><p>Your code must
<a class="reference internal" href="../setup/linux_build.html#building-firefox-on-linux"><span class="std std-ref">compile</span></a> and <a class="reference external" href="https://developer.mozilla.org/docs/Mozilla/QA/Automated_testing">pass all the automated tests</a>
before you consider pushing changes. If you are at all unsure, verify
your changes with the
<a class="reference external" href="https://wiki.mozilla.org/Build:TryServer">mozilla-central</a>.
try server, as appropriate.</p></li>
<li><p>You need <a class="reference internal" href="Code_Review_FAQ.html#code-review-faq"><span class="std std-ref">code review</span></a>.</p></li>
<li><p>Depending on the stage of the development process, you may need
<a class="reference external" href="https://wiki.mozilla.org/Tree_Rules">approval</a>. Commits to trees
where approval is required must have “a=” in the commit message
followed by the name of the approver.</p></li>
<li><p>Code should be factored in such a way such that we can disable
features which cause regressions, either by backout or via a kill
switch/preference. Be especially careful when landing features which
depend on other new features which may be disabled. Ask
mozilla.dev.planning for assistance if there are any questions.</p></li>
</ul>
</div>
<div class="section" id="checkin-comment">
<h2>Checkin comment<a class="headerlink" href="#checkin-comment" title="Permalink to this headline">¶</a></h2>
<p>The checkin comment for the change you push should include the bug
number, the names of the reviewers, and a clear explanation of the fix.
Please say what changes are made, not what problem was fixed, e.g.:</p>
<p>Good: “Bug 123456 - Null-check presentation shell so we don’t crash when a
button removes itself during its own onclick handler. r=paul, a=ringo.”</p>
<p>Bad: “Bug 123456 - crash clicking button on www.example.com”</p>
<p>If you are not the author of the code, use <code class="docutils literal notranslate"><span class="pre">hg</span> <span class="pre">commit</span> <span class="pre">-u</span></code> to specify
the actual author in the Mercurial changeset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hg</span> <span class="n">commit</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;Pat Chauthor &lt;pat@chauthor.com&gt;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="commit-message-restrictions">
<h2>Commit message restrictions<a class="headerlink" href="#commit-message-restrictions" title="Permalink to this headline">¶</a></h2>
<p>The purpose of these new restrictions, implemented via a mercurial hook,
is to prevent commit messages that do not have a bug number. We will
still allow a small set of special commits lacking bugs numbers, like
merges and backouts.</p>
<p>This hook will be enabled on mozilla-central and every major branch that
directly merges into it, such as autoland or integration
branches, team branches, or established project branches.</p>
<p>An example for a passing commit message would be,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Bug</span> <span class="mi">577872</span> <span class="o">-</span> <span class="n">Create</span> <span class="n">WebM</span> <span class="n">versions</span> <span class="n">of</span> <span class="n">Ogg</span> <span class="n">reftests</span><span class="o">.</span> <span class="n">r</span><span class="o">=</span><span class="n">kinetik</span>
</pre></div>
</div>
<p>Note the <em>Bug ####</em>, you at least need that. You also can’t commit
bustage-fixes without a bug number anymore. This is intentional to keep
track of the bug which caused it.</p>
<p>Allowed are:</p>
<ul class="simple">
<li><p>Commit messages containing “bug” or “b=” followed by a bug number</p></li>
<li><p>Commit messages containing “no bug” (please use this sparingly)</p></li>
<li><p>Commit message indicating backout of a given 12+ digit changeset ID,
starting with (back out|backing out|backed out|backout)( of)?
(rev|changeset|cset)s? [0-9a-f]{12}</p></li>
<li><p>Commit messages that start with “merge” or “merging” and are actually
for a merge changeset.</p></li>
</ul>
<p>Special exceptions:</p>
<ul class="simple">
<li><p>Commits by the special users “ffxbld”, “seabld”, “tbirdbld”, or
“cltbld”.</p></li>
<li><p>When the commit is older then some date shortly after the hook has
been enabled, to allow merges from other branches. This exception
will be lifted after a short period of time (probably a few months)
after the hooks is enabled.</p></li>
<li><p>You can also specify “IGNORE BAD COMMIT MESSAGES” in the tip (latest)
commit message to override all the restrictions. This is an extreme
measure, so you should only do this if you have a very good reason.</p></li>
</ul>
<p>Explicitly disallowed:</p>
<ul class="simple">
<li><p>Commit messages containing “try: ” to avoid unintentional commits
that were meant for the try server.</p></li>
</ul>
<p>All tests for allowed or excluded messages are case-insensitive. The
hook,
<a class="reference external" href="https://hg.mozilla.org/hgcustom/version-control-tools/file/tip/hghooks/mozhghooks/commit-message.py">commit-message.py</a>,
was added in <a class="reference external" href="https://bugzilla.mozilla.org/show_bug.cgi?id=506949">bug 506949</a>.</p>
</div>
<div class="section" id="check-the-tree">
<h2>Check the tree<a class="headerlink" href="#check-the-tree" title="Permalink to this headline">¶</a></h2>
<p>TaskCluster is a continuous build system that builds and tests every change
checked into autoland/mozilla-central and related source trees.
<a class="reference external" href="https://treeherder.mozilla.org/">Treeherder</a> displays the progress
and results of all the build and test jobs for a given tree. For a
particular job, green means all is well, orange means tests have failed,
and red means the build itself broke. Purple means that a test was
interrupted, possibly by a problem with the build system or the
network. Blue means that a test was interrupted in a known way and will
be automatically restarted. You can click on the “Help” link in the top
right corner of Treeherder for a legend to help you decode all the other
colors and letters.</p>
<p>If the tree is green, it is okay to check in. If some builds are orange
or red, you can either wait, or make sure all the failures are
classified with annotations/comments that reference bug numbers or
fixes.</p>
<p>If the tree is marked as “closed”, or if you have questions about any
oranges or reds, you should contact the sheriff before checking in.</p>
</div>
<div class="section" id="failures-and-backouts">
<h2>Failures and backouts<a class="headerlink" href="#failures-and-backouts" title="Permalink to this headline">¶</a></h2>
<p>Patches which cause unit test failures (on <a class="reference internal" href="../build/buildsystem/supported-configurations.html#supported-build-targets"><span class="std std-ref">tier 1
platforms</span></a>) will be backed out.
Regressions on tier-2 platforms and in performance are not cause for a
direct backout, but you will be expected to help fix them if quickly.</p>
<p><em>Note: Performance regressions require future data points to ensure a
sustained regression and can take anywhere from 3 hours to 30 hours
depending on the volume of the tree and build frequency. All regression
alerts do get briefly investigated and bugs are filed if necessary.</em></p>
<div class="section" id="dealing-with-test-failures">
<h3>Dealing with test failures<a class="headerlink" href="#dealing-with-test-failures" title="Permalink to this headline">¶</a></h3>
<p>If a build or a test job fails, you can click on the red or orange or
purple symbol for the job on Treeherder to display more information.
The information will appear in the footer, including a summary of any
error messages, a “+” icon to re-trigger the job (schedule it to run
again), and links to the log files and to possibly-related bugs.</p>
<p>Here are some steps you can follow to figure out what is causing most
failures, <a class="reference external" href="http://ehsanakhgari.org/blog/2010-04-09/assisted-starring-oranges">and “star” them
appropriately</a>:</p>
<ol class="arabic simple">
<li><p>Click on the failing job to see a list of suggested bugs. If the
failure clearly matches a known bug, <strong>click on the star</strong> next to
that bug and then click “Add a comment” and then submit the comment.
This is referred to as “starring the build;” you’ll see this phrase
or ones like it in IRC a lot.</p></li>
<li><p>If the failure might match a known bug but you are not sure, click
the bug number to open the Bugzilla report, and click the failing job
to open its log. If the log and the bug do match, add a comment as
in step 1 (above).</p></li>
<li><p>If the summary does not seem to match any suggested bugs, search
Bugzilla for the name of the failing test or the error message. If
you find a matching bug, add a comment in the bug in Bugzilla, and
another to the job in Treeherder.</p></li>
<li><p>If you can’t figure out whether a known bug exists (for example,
because you can’t figure out what part of the log you should search
for), look on Treeherder to see if there are other similar failures
nearby, or ask on #developers to see if anyone recognizes it as a
known failure. For example, many Android tests fail frequently in
ways that do not produce useful log messages. You can often find the
appropriate bug just by looking at other Android failures that are
already starred.</p></li>
<li><p>If there is no matching bug, you can back out the change (if you
suspect the failure was caused by your changeset) or re-trigger the
job (if you suspect it’s an unrelated intermittent failure). After
more test runs it should become clear whether it is a new regression
or just an unknown intermittent failure.</p></li>
<li><p>If it turns out to be an unknown intermittent failure, file a new bug
with “intermittent-failure” in the keywords. Include the name of the
test file and an one-line summary of the log messages in the Summary
field. In the description, include an excerpt of the error messages
from the log, and a link to the log file itself.</p></li>
</ol>
<p>At any point if you are not sure or can’t figure out what to do, ask for
advice or help in <a class="reference external" href="https://chat.mozilla.org">#developers</a>.
If a large number of jobs are failing and you suspect an infrastructure problem, you can also ask
about it in <a class="reference external" href="https://chat.mozilla.org">#releng</a>.</p>
</div>
<div class="section" id="dealing-with-performance-regressions">
<h3>Dealing with performance regressions<a class="headerlink" href="#dealing-with-performance-regressions" title="Permalink to this headline">¶</a></h3>
<p>Under some circumstances, if your patch causes a performance regression
that is not acceptable, it will get backed out.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>