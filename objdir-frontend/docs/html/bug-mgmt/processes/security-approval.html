

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Security Bug Approval Process &mdash; Firefox Source Docs  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/firefox.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Shared Bug Queues" href="shared-bug-queues.html" />
    <link rel="prev" title="How to Mark Regressions" href="regressions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Firefox Source Docs
          

          
            
            <img src="../../_static/firefox-wordmark.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup/index.html">Getting Set Up To Work On The Firefox Codebase</a></li>
</ul>
<p class="caption"><span class="caption-text">Working On Firefox</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Working on Firefox</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Bug Handling</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#guides">Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#policies">Policies</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#processes">Processes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="doc-requests.html">User documentation requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="fixing-security-bugs.html">Fixing Security Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="labels.html">GitHub Metadata Recommendations</a></li>
<li class="toctree-l3"><a class="reference internal" href="regressions.html">How to Mark Regressions</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Security Bug Approval Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#how-to-fix-a-core-security-bug-in-firefox-developer-guidelines">How to fix a core-security bug in Firefox - developer guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#purpose-don-t-0-day-ourselves">Purpose: don’t 0-day ourselves</a></li>
<li class="toctree-l4"><a class="reference internal" href="#principle-assume-the-worst">Principle: assume the worst</a></li>
<li class="toctree-l4"><a class="reference internal" href="#process-for-security-bugs-developer-perspective">Process for Security Bugs (Developer Perspective)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#process-for-security-bugs-sec-approver-perspective">Process for Security Bugs (sec-approver Perspective)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="shared-bug-queues.html">Shared Bug Queues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#related-documentation">Related documentation</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Source Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../browser/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dom/index.html">DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../layout/index.html">Layout &amp; CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gfx/index.html">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devtools/index.html">Firefox DevTools Contributor Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../toolkit/index.html">Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../js/index.html">SpiderMonkey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mobile/android/geckoview/index.html">Welcome to GeckoView’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dom/bindings/webidl/index.html">WebIDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/libpref/index.html">libpref</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../remote/index.html">Remote Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../services/common/services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uriloader/index.html">File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../widget/cocoa/index.html">Firefox on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code-quality/index.html">Code quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../writing-rust-code/index.html">Writing Rust Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/profiler/index.html">Gecko Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">The Firefox Build System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../mach/index.html">Mach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/try/index.html">Try Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../build/buildsystem/index.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../taskcluster/index.html">TaskCluster Task-Graph Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/moztreedocs/index.html">Managing Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Testing &amp; Test Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../testing/testing-policy/index.html">Testing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/marionette/index.html">Marionette</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/geckodriver/index.html">geckodriver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../web-platform/index.html">web-platform-tests documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/fuzzing/index.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/sanitizer/index.html">Sanitizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/perfdocs/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/code-coverage/index.html">Code coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing-rust-code/index.html">Testing &amp; Debugging Rust Code</a></li>
</ul>
<p class="caption"><span class="caption-text">Localization &amp; Internationalization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intl/index.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../l10n/index.html">Localization</a></li>
</ul>
<p class="caption"><span class="caption-text">Firefox and Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../mozbase/index.html">mozbase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/index.html">Using third-party Python packages</a></li>
</ul>
<p class="caption"><span class="caption-text">Metrics Collected in Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../metrics/index.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metrics/index.html#pings">Pings</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Firefox Source Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Bug Handling</a> &raquo;</li>
        
      <li>Security Bug Approval Process</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/bug-mgmt/processes/security-approval.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="security-bug-approval-process">
<h1>Security Bug Approval Process<a class="headerlink" href="#security-bug-approval-process" title="Permalink to this headline">¶</a></h1>
<div class="section" id="how-to-fix-a-core-security-bug-in-firefox-developer-guidelines">
<h2>How to fix a core-security bug in Firefox - developer guidelines<a class="headerlink" href="#how-to-fix-a-core-security-bug-in-firefox-developer-guidelines" title="Permalink to this headline">¶</a></h2>
<p>Follow these security guidelines if you’re involved in reviewing,
testing and landing a security patch:
<a class="reference internal" href="fixing-security-bugs.html#fixing-security-bugs"><span class="std std-ref">Fixing Security Bugs</span></a>.</p>
</div>
<div class="section" id="purpose-don-t-0-day-ourselves">
<h2>Purpose: don’t 0-day ourselves<a class="headerlink" href="#purpose-don-t-0-day-ourselves" title="Permalink to this headline">¶</a></h2>
<p>People watch our check-ins. They may be able to start exploiting our
users before we can get an update out to them if</p>
<ul class="simple">
<li><p>the patch is an obvious security fix (bounds check, kungFuDeathGrip,
etc.)</p></li>
<li><p>the check-in comment says “security fix” or includes trigger words
like “exploitable”, “vulnerable”, “overflow”, “injection”, “use after
free”, etc.</p></li>
<li><p>comments in the code mention those types of things or how someone
could abuse the bug</p></li>
<li><p>the check-in contains testcases that show exactly how to trigger the
vulnerability</p></li>
</ul>
</div>
<div class="section" id="principle-assume-the-worst">
<h2>Principle: assume the worst<a class="headerlink" href="#principle-assume-the-worst" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>If there’s no rating we assume it could be critical</p></li>
<li><p>If we don’t know the regression range we assume it needs porting to
all supported branches</p></li>
</ul>
</div>
<div class="section" id="process-for-security-bugs-developer-perspective">
<h2>Process for Security Bugs (Developer Perspective)<a class="headerlink" href="#process-for-security-bugs-developer-perspective" title="Permalink to this headline">¶</a></h2>
<div class="section" id="filing-managing-bugs">
<h3>Filing / Managing Bugs<a class="headerlink" href="#filing-managing-bugs" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Try whenever possible to file security bugs marked as such when
filing, instead of filing them as open bugs and then closing later.
This is not always possible, but attention to this, especially when
filing from crash-stats, is helpful.</p></li>
<li><p>Avoid linking it to non-security bugs with Blocks, Depends,
Regressions, or See Also, especially if those bugs may give a hint to
the sort of security issue involved. Mention the bug in a comment on
the security bug instead. We can always fill in the links later after
the fix has shipped.</p></li>
</ul>
</div>
<div class="section" id="developing-the-patch">
<h3>Developing the Patch<a class="headerlink" href="#developing-the-patch" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Comments in the code should not mention a security issue is being
fixed. Don’t paint a picture or an arrow pointing to security issues
any more than the code changes already do.</p></li>
<li><p>Avoid linking it to non-security bugs with Blocks, Depends, or See
Also, especially if those bugs may give a hint to the sort of
security issue involved. Mention the bug in a comment on the security
bug instead. We can always fill in the links later after the fix has
shipped.</p></li>
<li><p>Do not push to Try servers if possible: this exposes the security
issues for these critical and high rated bugs to public viewing. In
an ideal case, testing of patches is done locally before final
check-in to mozilla-central.</p></li>
<li><p>If pushing to Try servers is necessary, <strong>do not include the bug
number in the patch</strong>. Ideally, do not include tests in the push as
the tests can illustrate the exact nature of the security problem
frequently.</p></li>
<li><p>If you must push to Try servers, with or without tests, try to
obfuscate what this patch is for. Try to push it with other,
non-security work, in the same area.</p></li>
</ul>
<p>Request review of the patch in the same process as normal. After the
patch has received an r+ you will request sec-approval. See
<a class="reference internal" href="fixing-security-bugs.html#fixing-security-bugs"><span class="std std-ref">Fixing Security Bugs</span></a>
for more examples/details of these points.</p>
</div>
<div class="section" id="on-requesting-sec-approval">
<h3>On Requesting sec-approval<a class="headerlink" href="#on-requesting-sec-approval" title="Permalink to this headline">¶</a></h3>
<p>For security bugs with no sec- severity rating assume the worst and
follow the rules for sec-critical. During the sec-approval process we
will notice it has not been rated and rate it during the process.</p>
<p>Core-security bug fixes can be landed by a developer without any
explicit approval if:</p>
<div class="line-block">
<div class="line"><strong>A)</strong> The bug has a sec-low, sec-moderate, sec-other, or sec-want
rating.</div>
<div class="line">   <strong>or</strong></div>
<div class="line"><strong>B)</strong> The bug is a recent regression on mozilla-central. This means</div>
</div>
<ul class="simple">
<li><p>A specific regressing check-in has been identified</p></li>
<li><p>The developer can (<strong>and has</strong>) marked the status flags for ESR,
Beta, and Aurora as “unaffected”</p></li>
<li><p>We have not shipped this vulnerability in anything other than a
nightly build</p></li>
</ul>
<p>If it meets the above criteria, check that patch in.</p>
<p>Otherwise, if the bug has a patch *and* is sec-high or sec-critical,
the developer should prepare the patch for sec-approval. This entails:</p>
<ul class="simple">
<li><p>Commit should occur without specific mention of security, security
bugs, or sec-approvers if possible. While comprehensive commit
messages are generally encouraged; they should be omitted for
security bugs and instead be posted in the bug (which will eventually
become public.)</p></li>
<li><p>Separate out tests into a separate commit. <strong>Do not commit tests when
checking in</strong> when the security bug fix is initially checked-in.
<strong>Remember we don’t want to 0-day ourselves!</strong></p>
<ul>
<li><p>Tests should only be checked in later, after an official Firefox
release that contains the fix has gone live and not for at least
four weeks following that release. For example, if Firefox 53
contains a fix for a security issue that affects the world and is
then fixed in 54, tests for this fix should not be checked in
until four weeks after 54 goes live. The exception to this is if
there is a security issue that hasn’t shipped in a release build
and it is being fixed on multiple development branches (such as
mozilla-central and beta). Since the security problem was never
released to the world, once the bug is fixed in all affected
places, tests can be checked in to the various branches.</p></li>
<li><p>There are two main techniques for remembering to check in the
tests later:</p>
<ul>
<li><p>clone the sec bug into a hidden “task” bug “land tests for bug
xxxxx” and assign to yourself. It should get a “sec-other”
keyword rating.</p></li>
<li><p>Or, set the “in-testsuite” flag to “?”, and later set it to “+”
when the tests get checked in.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Following that, set the sec-approval flag to ‘?’ on the patch when it is
ready to be checked into mozilla-central (or elsewhere if it is branch
only).</p>
<p>If developers are unsure about a bug and it has a patch ready, just
request sec-approval anyway and move on. Don’t overthink it!</p>
<p>An automatic nomination comment will be added to bugzilla when
sec-approval is set to ‘?’. The questions in this need to be filled out
as best as possible when sec-approval is requested for the patch.</p>
<p>It is as follows (courtesy of Dan Veditz):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Security approval request comment]
How easily can the security issue be deduced from the patch?
Do comments in the patch, the check-in comment, or tests included in
the patch paint a bulls-eye on the security problem?
Which older supported branches are affected by this flaw?
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how
different, hard to create, and risky will they be?
How likely is this patch to cause regressions; how much testing does
it need?
</pre></div>
</div>
<p>This is similar to the ESR approval nomination form and is meant to help
us evaluate the risks around approving the patch for checkin.</p>
<p>When the bug is approved for landing, the sec-approval flag will be set
to ‘+’ with a comment from the approver to land the patch. At that
point, land it according to instructions provided..</p>
<p>This will allow us to control when we can land security bugs without
exposing them too early and to make sure they get landed on the various
branches.</p>
<p>If you have any questions or are unsure about anything in this document
contact us on Slack in the #security channel or the current
sec-approvers Dan Veditz and Tom Ritter.</p>
</div>
</div>
<div class="section" id="process-for-security-bugs-sec-approver-perspective">
<h2>Process for Security Bugs (sec-approver Perspective)<a class="headerlink" href="#process-for-security-bugs-sec-approver-perspective" title="Permalink to this headline">¶</a></h2>
<p>The security assurance team and release management will have their own
process for approving bugs:</p>
<ol class="arabic simple">
<li><p>The Security assurance team goes through sec-approval ? bugs daily
and approves low risk fixes for central (if early in cycle).
Developers can also ping the Security Assurance Team (specifically
Tom Ritter &amp; Dan Veditz) in #security on Slack when important.</p>
<ol class="arabic simple">
<li><p>If a bug lacks a security-rating one should be assigned - possibly
in coordination with the (other member of) the Security Assurance
Team</p></li>
</ol>
</li>
<li><p>Security team marks tracking flags to ? for all affected versions
when approved for central. (This allows release management to decide
whether to uplift to branches just like always.)</p></li>
<li><p>Weekly security/release management triage meeting goes through
sec-approval + and ? bugs where beta and ESR is affected, ? bugs with
higher risk (sec-high and sec-critical), or ? bugs near end of cycle.</p></li>
</ol>
<p>Options for sec-approval including a logical combination of the
following:</p>
<ul class="simple">
<li><p>Separate out the test and comments in the code into a followup commit
we will commit later.</p></li>
<li><p>Remove the commit message and place it in the bug or comments in a
followup commit.</p></li>
<li><p>Please land it bundled in with another commit</p></li>
<li><p>Land today</p></li>
<li><p>Land today, land the tests after</p></li>
<li><p>Land closer to the release date</p></li>
<li><p>Land in Nightly to assess stability</p></li>
<li><p>Land today and request uplift to all branches</p></li>
<li><p>Request uplift to all branches and we’ll land as close to shipping as
permitted</p></li>
<li><p>Chemspill time</p></li>
</ul>
<p>The decision process for which of these to choose is perceived risk on
multiple axes:</p>
<ul class="simple">
<li><p>ease of exploitation</p></li>
<li><p>reverse engineering risk</p></li>
<li><p>stability risk</p></li>
</ul>
<p>The most common choice is: not much stability risk, not an immediate RE
risk, moderate to high difficulty of exploitation: “land whenever”</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="shared-bug-queues.html" class="btn btn-neutral float-right" title="Shared Bug Queues" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="regressions.html" class="btn btn-neutral float-left" title="How to Mark Regressions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>