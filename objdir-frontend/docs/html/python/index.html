

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using third-party Python packages &mdash; Firefox Source Docs  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/firefox.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.4/mermaid.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Metrics" href="../metrics/index.html" />
    <link rel="prev" title="mozdevice — Interact with Android devices" href="../mozbase/mozdevice.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Firefox Source Docs
          

          
            
            <img src="../_static/firefox-wordmark.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Getting Set Up To Work On The Firefox Codebase</a></li>
</ul>
<p class="caption"><span class="caption-text">Working On Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Working on Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bug-mgmt/index.html">Bug Handling</a></li>
</ul>
<p class="caption"><span class="caption-text">Source Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../browser/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dom/index.html">DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../layout/index.html">Layout &amp; CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gfx/index.html">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devtools/index.html">Firefox DevTools Contributor Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toolkit/index.html">Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../js/index.html">SpiderMonkey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mobile/android/geckoview/index.html">Welcome to GeckoView’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dom/bindings/webidl/index.html">WebIDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/libpref/index.html">libpref</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remote/index.html">Remote Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/common/services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uriloader/index.html">File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../widget/cocoa/index.html">Firefox on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code-quality/index.html">Code quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writing-rust-code/index.html">Writing Rust Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/profiler/index.html">Gecko Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">The Firefox Build System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mach/index.html">Mach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/try/index.html">Try Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build/buildsystem/index.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../taskcluster/index.html">TaskCluster Task-Graph Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/moztreedocs/index.html">Managing Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Testing &amp; Test Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/testing-policy/index.html">Testing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/marionette/index.html">Marionette</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/geckodriver/index.html">geckodriver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web-platform/index.html">web-platform-tests documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/fuzzing/index.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/sanitizer/index.html">Sanitizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/perfdocs/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/code-coverage/index.html">Code coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing-rust-code/index.html">Testing &amp; Debugging Rust Code</a></li>
</ul>
<p class="caption"><span class="caption-text">Localization &amp; Internationalization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intl/index.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../l10n/index.html">Localization</a></li>
</ul>
<p class="caption"><span class="caption-text">Firefox and Python</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../mozbase/index.html">mozbase</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using third-party Python packages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#vendoring-python-packages">Vendoring Python packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-a-python-package">Adding a Python package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-if-the-package-isn-t-on-pypi">What if the package isn’t on PyPI?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-a-python-package-index">Using a Python package index</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Metrics Collected in Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../metrics/index.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/index.html#pings">Pings</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Firefox Source Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Using third-party Python packages</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/python/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-third-party-python-packages">
<h1>Using third-party Python packages<a class="headerlink" href="#using-third-party-python-packages" title="Permalink to this headline">¶</a></h1>
<p>When using third-party Python packages, there are two options:</p>
<ol class="arabic simple">
<li><p>Install/use a vendored version of the package.</p></li>
<li><p>Install the package from a package index, such as PyPI or our internal
mirror.</p></li>
</ol>
<div class="section" id="vendoring-python-packages">
<h2>Vendoring Python packages<a class="headerlink" href="#vendoring-python-packages" title="Permalink to this headline">¶</a></h2>
<p>If the Python package is to be used in the building of Firefox itself, then we
<strong>MUST</strong> use a vendored version. This ensures that to build Firefox we only
require a checkout of the source, and do not depend on a package index. This
ensures that building Firefox is deterministic and dependable, avoids packages
from changing out from under us, and means we’re not affected when 3rd party
services are offline. We don’t want a DoS against PyPI or a random package
maintainer removing an old tarball to delay a Firefox chemspill.</p>
<p>Where possible, the following policy applies to <strong>ALL</strong> vendored packages:</p>
<ul class="simple">
<li><p>Vendored libraries <strong>SHOULD NOT</strong> be modified except as required to
successfully vendor them.</p></li>
<li><p>Vendored libraries <strong>SHOULD</strong> be released copies of libraries available on
PyPI.</p></li>
</ul>
<div class="section" id="adding-a-python-package">
<h3>Adding a Python package<a class="headerlink" href="#adding-a-python-package" title="Permalink to this headline">¶</a></h3>
<p>To vendor a Python package, run <code class="docutils literal notranslate"><span class="pre">mach</span> <span class="pre">vendor</span> <span class="pre">python</span> <span class="pre">[PACKAGE]</span></code>, where
<code class="docutils literal notranslate"><span class="pre">[PACKAGE]</span></code> is one or more package names along with a version number in the
format <code class="docutils literal notranslate"><span class="pre">pytest==3.5.1</span></code>. The package will be installed, transient dependencies
will be determined, and a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file will be generated with the
full list of dependencies. The requirements file is then used with <code class="docutils literal notranslate"><span class="pre">pip</span></code> to
download and extract the source distributions of all packages into the
<code class="docutils literal notranslate"><span class="pre">third_party/python</span></code> directory.</p>
<p>Alternatively, you can also modify the direct dependencies in
<code class="docutils literal notranslate"><span class="pre">third_party/python/requirements.in</span></code> and then run <code class="docutils literal notranslate"><span class="pre">mach</span> <span class="pre">vendor</span> <span class="pre">python</span></code> for your
changes to take effect.</p>
</div>
<div class="section" id="what-if-the-package-isn-t-on-pypi">
<h3>What if the package isn’t on PyPI?<a class="headerlink" href="#what-if-the-package-isn-t-on-pypi" title="Permalink to this headline">¶</a></h3>
<p>If the package isn’t available on any Python package index, then you can
manually copy the source distribution into the <code class="docutils literal notranslate"><span class="pre">third_party/python</span></code> directory.</p>
</div>
</div>
<div class="section" id="using-a-python-package-index">
<h2>Using a Python package index<a class="headerlink" href="#using-a-python-package-index" title="Permalink to this headline">¶</a></h2>
<p>If the Python package is not used in the building of Firefox then it can be
installed from a package index. Some tasks are not permitted to use external
resources, and for those we can publish packages to an internal PyPI mirror.
See <a class="reference external" href="https://wiki.mozilla.org/ReleaseEngineering/How_To/Upload_to_internal_Pypi">how to upload to internal PyPI</a>
for more details. If you are not restricted, you can install packages from PyPI
or another package index.</p>
<p>All packages installed from a package index <strong>MUST</strong> specify hashes to ensure
compatibility and protect against remote tampering. Hash-checking mode can be
forced on when using <code class="docutils literal notranslate"><span class="pre">pip</span></code> be specifying the <code class="docutils literal notranslate"><span class="pre">--require-hashes</span></code>
command-line option. See <a class="reference external" href="https://pip.pypa.io/en/stable/reference/pip_install/#hash-checking-mode">hash-checking mode</a> for
more details.</p>
<p>Note that when using a Python package index there is a risk that the service
could be unavailable, or packages may be updated or even pulled without notice.
These issues are less likely with our internal PyPI mirror, but still possible.
If this is undesirable, then consider vendoring the package.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../metrics/index.html" class="btn btn-neutral float-right" title="Metrics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../mozbase/mozdevice.html" class="btn btn-neutral float-left" title="mozdevice — Interact with Android devices" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>