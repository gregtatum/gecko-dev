

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quick Intro &mdash; Firefox Source Docs  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/firefox.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.4/mermaid.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Getting data from the store" href="redux-guidelines.html" />
    <link rel="prev" title="Guidelines for Writing React" href="react-guidelines.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Firefox Source Docs
          

          
            
            <img src="../../_static/firefox-wordmark.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup/index.html">Getting Set Up To Work On The Firefox Codebase</a></li>
</ul>
<p class="caption"><span class="caption-text">Working On Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Working on Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bug-mgmt/index.html">Bug Handling</a></li>
</ul>
<p class="caption"><span class="caption-text">Source Code Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../browser/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dom/index.html">DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../layout/index.html">Layout &amp; CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gfx/index.html">Graphics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Firefox DevTools Contributor Docs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#contributing">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#automated-tests">Automated tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#files-and-directories">Files and directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tool-architectures">Tool Architectures</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#frontend">Frontend</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="svgs.html">Panel SVGs</a></li>
<li class="toctree-l3"><a class="reference internal" href="react.html">React</a></li>
<li class="toctree-l3"><a class="reference internal" href="react-guidelines.html">React Guidelines</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Redux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#evolution-of-flux">Evolution of Flux</a></li>
<li class="toctree-l4"><a class="reference internal" href="#immutability">Immutability</a></li>
<li class="toctree-l4"><a class="reference internal" href="#order-of-execution">Order of Execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#next">Next</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="redux-guidelines.html">Redux Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="telemetry.html">Telemetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="csp.html">Current DevTools CSP</a></li>
<li class="toctree-l3"><a class="reference internal" href="csp.html#scope-of-the-devtools-csp">Scope of the DevTools CSP</a></li>
<li class="toctree-l3"><a class="reference internal" href="csp.html#recognizing-csp-issues">Recognizing CSP issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="csp.html#fixing-csp-issues">Fixing CSP issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="csp.html#fixing-csp-issues-in-tests">Fixing CSP issues in tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#backend">Backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#preferences">Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#about-this-documentation">About this documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../toolkit/index.html">Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../js/index.html">SpiderMonkey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mobile/android/geckoview/index.html">Welcome to GeckoView’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dom/bindings/webidl/index.html">WebIDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/libpref/index.html">libpref</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../remote/index.html">Remote Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../services/common/services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uriloader/index.html">File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../widget/cocoa/index.html">Firefox on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code-quality/index.html">Code quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../writing-rust-code/index.html">Writing Rust Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/profiler/index.html">Gecko Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">The Firefox Build System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../mach/index.html">Mach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/try/index.html">Try Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../build/buildsystem/index.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../taskcluster/index.html">TaskCluster Task-Graph Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/moztreedocs/index.html">Managing Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Testing &amp; Test Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../testing/testing-policy/index.html">Testing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/marionette/index.html">Marionette</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/geckodriver/index.html">geckodriver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../web-platform/index.html">web-platform-tests documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/fuzzing/index.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/sanitizer/index.html">Sanitizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/perfdocs/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/code-coverage/index.html">Code coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing-rust-code/index.html">Testing &amp; Debugging Rust Code</a></li>
</ul>
<p class="caption"><span class="caption-text">Localization &amp; Internationalization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intl/index.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../l10n/index.html">Localization</a></li>
</ul>
<p class="caption"><span class="caption-text">Firefox and Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../mozbase/index.html">mozbase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/index.html">Using third-party Python packages</a></li>
</ul>
<p class="caption"><span class="caption-text">Metrics Collected in Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../metrics/index.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metrics/index.html#pings">Pings</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Firefox Source Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Firefox DevTools Contributor Docs</a> &raquo;</li>
        
      <li>Quick Intro</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/devtools/frontend/redux.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>We use <a class="reference external" href="https://github.com/reactjs/redux">Redux</a> to manage application
state. The <a class="reference external" href="http://redux.js.org/">docs</a> do a good job explaining the
concepts, so go read them.</p>
<div class="section" id="quick-intro">
<h1>Quick Intro<a class="headerlink" href="#quick-intro" title="Permalink to this headline">¶</a></h1>
<p>Just like the <a class="reference external" href="react.html">React introduction</a>, this is a quick
introduction to redux, focusing on how it fits into React and why we
chose it.</p>
<p>One of the core problems that React does not address is managing
state. In the React intro, we talked about data flowing down and
events flowing up. Conceptually this is nice, but you quickly run into
awkward situations in large apps.</p>
<p>Let’s look at an example. Say you have a page with a tabbed interface.
Here, <code class="docutils literal notranslate"><span class="pre">Tab1</span></code> is managing a list of items, so naturally it uses local
state. <code class="docutils literal notranslate"><span class="pre">Tab2</span></code> renders different stuff.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">Tab1</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">getInitialState</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[]</span> <span class="p">};</span>
  <span class="p">},</span>

  <span class="nx">handleAddItem</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">items</span><span class="o">:</span> <span class="p">[...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">items</span><span class="p">,</span> <span class="nx">item</span><span class="p">]});</span>
  <span class="p">},</span>

  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="cm">/* ... Renders the items and button to add new item ... */</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kr">const</span> <span class="nx">Tab2</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="cm">/* ... Renders other data ... */</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// Assume `Tab1` and `Tab2` are wrapped with a factory when importing</span>
<span class="kr">const</span> <span class="nx">Tabs</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">div</span><span class="p">(</span>
      <span class="p">{</span> <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;tabs&#39;</span> <span class="p">},</span>
      <span class="c1">// ... Render the tab buttons ...</span>
      <span class="nx">Tab1</span><span class="p">(),</span>
      <span class="nx">Tab2</span><span class="p">()</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>What happens when <code class="docutils literal notranslate"><span class="pre">Tab2</span></code> needs the list of items though? This scenario
comes up all time: components that aren’t directly related need access
to the same state. A small change would be to move the <code class="docutils literal notranslate"><span class="pre">items</span></code> state
up to the <code class="docutils literal notranslate"><span class="pre">Tabs</span></code> component, and pass it down to both <code class="docutils literal notranslate"><span class="pre">Tab1</span></code> and <code class="docutils literal notranslate"><span class="pre">Tab2</span></code>.</p>
<p>But now <code class="docutils literal notranslate"><span class="pre">Tabs</span></code> has to implement the <code class="docutils literal notranslate"><span class="pre">handleAddItem</span></code> method to add an
item because it’s managing that state. This quickly gets ugly as the
end result is the root component ends up with a ton of state and
methods to manage it: a <a class="reference external" href="https://en.wikipedia.org/wiki/God_object">god
component</a> is born.</p>
<p>Additionally, how do we know what data each tab needs? We end up
passing <em>all</em> the state down because we don’t know. This is not a
modular solution: one object managing the state and every component
receiving the entire state is like using tons of global variables.</p>
<div class="section" id="evolution-of-flux">
<h2>Evolution of Flux<a class="headerlink" href="#evolution-of-flux" title="Permalink to this headline">¶</a></h2>
<p>Facebook addressed this with the
<a class="reference external" href="https://facebook.github.io/flux/">flux</a> architecture, which takes the
state out of the components and into a “store”. Redux is the latest
evolution of this idea and solves a lot of problems previous flux
libraries had (read it’s documentation for more info).</p>
<p>Because the state exists outside the component tree, any component can
read from it. Additionally, <strong>state is updated with
<a class="reference external" href="http://redux.js.org/docs/basics/Actions.html">actions</a></strong> that any
component can fire. We have <a class="reference internal" href="redux-guidelines.html"><span class="doc">guidelines</span></a> for where
to read/write state, but it completely solves the problem described
above. Both <code class="docutils literal notranslate"><span class="pre">Tab1</span></code> and <code class="docutils literal notranslate"><span class="pre">Tab2</span></code> would be listening for changes in the
<code class="docutils literal notranslate"><span class="pre">item</span></code> state, and <code class="docutils literal notranslate"><span class="pre">Tab1</span></code> would fire actions to change it.</p>
<p>With redux, <strong>state is managed modularly with
<a class="reference external" href="http://redux.js.org/docs/basics/Reducers.html">reducers</a></strong> but tied
together into a single object. This means a single JS object
represents most* of your state. It may sound crazy at first, but think
of it as an object with references to many pieces of state; that’s all
it is.</p>
<p>This makes it very easy to test, debug, and generally think about. You
can log your entire state to the console and inspect it. You can even
dump in old states and “replay” to see how the UI changed over time.</p>
<p>I said “most*” because it’s perfectly fine to use both component local
state and redux. Be aware that any debugging tools will not see local
state at all though. It should only be used for transient state; we’ll
talk more about that in the guidelines.</p>
</div>
<div class="section" id="immutability">
<h2>Immutability<a class="headerlink" href="#immutability" title="Permalink to this headline">¶</a></h2>
<p>Another important concept is immutability. In large apps, mutating
state makes it very hard to track what changed when. It’s very easy to
run into situations where something changes out from under you, and
the UI is rendered with invalid data.</p>
<p>Redux enforces the state to be updated immutably. That means you
always return new state. It doesn’t mean you do a deep copy of the
state each time: when you need to change some part of the tree you
only need to create new objects to replace the ones your changing (and
walk up to the root to create a new root). Unchanged subtrees will
reference the same objects.</p>
<p>This removes a whole class of errors, almost like Rust removing a
whole class of memory errors by enforcing ownership.</p>
</div>
<div class="section" id="order-of-execution">
<h2>Order of Execution<a class="headerlink" href="#order-of-execution" title="Permalink to this headline">¶</a></h2>
<p>One of best things about React is that <strong>rendering is synchronous</strong>. That
means when you render a component, given some data, it will fully
render in the same tick. If you want the UI to change over time, you
have to change the <em>data</em> and rerender, instead of arbitrary UI
mutations.</p>
<p>The reason this is desired is because if you build the UI around
promises or event emitters, updating the UI becomes very brittle
because anything can happen at any time. The state might be updated in
the middle of rendering it, maybe because you resolved a few promises
which made your rendering code run a few ticks later.</p>
<p>Redux embraces the synchronous execution semantics as well. What this
means is that everything happens in a very controlled way. When
updating state through an action, all reducers are run and a new state
is synchronously generated. At that point, the new state is handed off
to React and synchronously rendered.</p>
<p>Updating and rendering happen in two phases, so the UI will <em>always</em>
represent consistent state. The state can never be in the middle of
updating when rendering.</p>
<p>What about asynchronous work? That’s where
<a class="reference external" href="http://redux.js.org/docs/advanced/Middleware.html">middleware</a> come
in. At this point you should probably go study our code, but
middleware allows you to dispatch special actions that indicate
asynchronous work. The middleware will catch these actions and do
something async, dispatching “raw” actions along the way (it’s common
to emit a START, DONE, and ERROR action).</p>
<p><strong>Ultimately there are 3 “phases” or level of abstraction</strong>: the async
layer talks to the network and may dispatch actions, actions are
synchronously pumped through reducers to generate state, and state is
rendered with react.</p>
</div>
<div class="section" id="next">
<h2>Next<a class="headerlink" href="#next" title="Permalink to this headline">¶</a></h2>
<p>Read the <a class="reference internal" href="redux-guidelines.html"><span class="doc">Redux Guidelines</span></a> next to learn how to
write React code specifically for the devtools.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="redux-guidelines.html" class="btn btn-neutral float-right" title="Getting data from the store" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="react-guidelines.html" class="btn btn-neutral float-left" title="Guidelines for Writing React" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>