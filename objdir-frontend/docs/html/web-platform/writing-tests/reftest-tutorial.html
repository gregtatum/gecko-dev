

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Writing a reftest &mdash; Firefox Source Docs  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/firefox.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.4/mermaid.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Print Reftests" href="print-reftests.html" />
    <link rel="prev" title="Reftests" href="reftests.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Firefox Source Docs
          

          
            
            <img src="../../_static/firefox-wordmark.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup/index.html">Getting Set Up To Work On The Firefox Codebase</a></li>
</ul>
<p class="caption"><span class="caption-text">Working On Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Working on Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bug-mgmt/index.html">Bug Handling</a></li>
</ul>
<p class="caption"><span class="caption-text">Source Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../browser/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dom/index.html">DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../layout/index.html">Layout &amp; CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gfx/index.html">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devtools/index.html">Firefox DevTools Contributor Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../toolkit/index.html">Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../js/index.html">SpiderMonkey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mobile/android/geckoview/index.html">Welcome to GeckoView’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dom/bindings/webidl/index.html">WebIDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/libpref/index.html">libpref</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../remote/index.html">Remote Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../services/common/services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uriloader/index.html">File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../widget/cocoa/index.html">Firefox on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code-quality/index.html">Code quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../writing-rust-code/index.html">Writing Rust Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/profiler/index.html">Gecko Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">The Firefox Build System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../mach/index.html">Mach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/try/index.html">Try Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../build/buildsystem/index.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../taskcluster/index.html">TaskCluster Task-Graph Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/moztreedocs/index.html">Managing Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Testing &amp; Test Infrastructure</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../testing/testing-policy/index.html">Testing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/marionette/index.html">Marionette</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/geckodriver/index.html">geckodriver</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">web-platform-tests documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#video-introduction-transcript">Video Introduction (transcript)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#github">GitHub</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#table-of-contents">Table of Contents</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../test-suite-design.html">Test Suite Design</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro-video-transcript.html">“Introduction to WPT” video transcript</a></li>
<li class="toctree-l3"><a class="reference internal" href="../running-tests/index.html">Running Tests</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Writing Tests</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="index.html#test-types">Test Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#submitting-tests">Submitting Tests</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html#table-of-contents">Table of Contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reviewing-tests/index.html">Reviewing Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/index.html">Project Administration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/fuzzing/index.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/sanitizer/index.html">Sanitizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/perfdocs/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/code-coverage/index.html">Code coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing-rust-code/index.html">Testing &amp; Debugging Rust Code</a></li>
</ul>
<p class="caption"><span class="caption-text">Localization &amp; Internationalization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intl/index.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../l10n/index.html">Localization</a></li>
</ul>
<p class="caption"><span class="caption-text">Firefox and Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../mozbase/index.html">mozbase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/index.html">Using third-party Python packages</a></li>
</ul>
<p class="caption"><span class="caption-text">Metrics Collected in Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../metrics/index.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metrics/index.html#pings">Pings</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Firefox Source Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">web-platform-tests documentation</a> &raquo;</li>
        
          <li><a href="index.html">Writing Tests</a> &raquo;</li>
        
      <li>Writing a reftest</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/web-platform/writing-tests/reftest-tutorial.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="writing-a-reftest">
<h1>Writing a reftest<a class="headerlink" href="#writing-a-reftest" title="Permalink to this headline">¶</a></h1>
<!--
Note to maintainers:

This tutorial is designed to be an authentic depiction of the WPT contribution
experience. It is not intended to be comprehensive; its scope is intentionally
limited in order to demonstrate authoring a complete test without overwhelming
the reader with features. Because typical WPT usage patterns change over time,
this should be updated periodically; please weigh extensions against the
demotivating effect that a lengthy guide can have on new contributors.
--><p>Let’s say you’ve discovered that WPT doesn’t have any tests for the <code class="docutils literal notranslate"><span class="pre">dir</span></code>
attribute of <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/bdo">the <code class="docutils literal notranslate"><span class="pre">&lt;bdo&gt;</span></code>
element</a>. This
tutorial will guide you through the process of writing and submitting a test.
You’ll need to <a class="reference internal" href="../running-tests/from-local-system.html"><span class="doc">configure your system to use WPT’s
tools</span></a>, but you won’t need them until
towards the end of this tutorial. Although it includes some very brief
instructions on using git, you can find more guidance in <a class="reference internal" href="github-intro.html"><span class="doc">the tutorial for git
and GitHub</span></a>.</p>
<p>WPT’s reftests are great for testing web-platform features that have some
visual effect. <a class="reference internal" href="reftests.html"><span class="doc">The reftests reference page</span></a> describes them in the
abstract, but for the purposes of this guide, we’ll only consider the features
we need to test the <code class="docutils literal notranslate"><span class="pre">&lt;bdo&gt;</span></code> element.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#setting-up-your-workspace" id="id1">Setting up your workspace</a></p></li>
<li><p><a class="reference internal" href="#writing-the-test-file" id="id2">Writing the test file</a></p></li>
<li><p><a class="reference internal" href="#writing-a-match-reference" id="id3">Writing a “match” reference</a></p></li>
<li><p><a class="reference internal" href="#verifying-our-work" id="id4">Verifying our work</a></p></li>
<li><p><a class="reference internal" href="#submitting-the-test" id="id5">Submitting the test</a></p></li>
<li><p><a class="reference internal" href="#more-practice" id="id6">More practice</a></p></li>
</ul>
</div>
<div class="section" id="setting-up-your-workspace">
<h2><a class="toc-backref" href="#id1">Setting up your workspace</a><a class="headerlink" href="#setting-up-your-workspace" title="Permalink to this headline">¶</a></h2>
<p>To make sure you have the latest code, first type the following into a terminal
located in the root of the WPT git repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git fetch git@github.com:web-platform-tests/wpt.git
</pre></div>
</div>
<p>Next, we need a place to store the change set we’re about to author. Here’s how
to create a new git branch named <code class="docutils literal notranslate"><span class="pre">reftest-for-bdo</span></code> from the revision of WPT we
just downloaded:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git checkout -b reftest-for-bdo FETCH_HEAD
</pre></div>
</div>
<p>Now you’re ready to create your patch.</p>
</div>
<div class="section" id="writing-the-test-file">
<h2><a class="toc-backref" href="#id2">Writing the test file</a><a class="headerlink" href="#writing-the-test-file" title="Permalink to this headline">¶</a></h2>
<p>First, we’ll create a file that demonstrates the “feature under test.” That is:
we’ll write an HTML document that displays some text using a <code class="docutils literal notranslate"><span class="pre">&lt;bdo&gt;</span></code> element.</p>
<p>WPT has thousands of tests, so it can be daunting to decide where to put a new
one. Generally speaking, <a class="reference internal" href="../test-suite-design.html"><span class="doc">test files should be placed in directories
corresponding to the specification text they are
verifying</span></a>. <code class="docutils literal notranslate"><span class="pre">&lt;bdo&gt;</span></code> is defined in <a class="reference external" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html">the “text-level
semantics” chapter of the HTML
specification</a>,
so we’ll want to create our new test in the directory
<code class="docutils literal notranslate"><span class="pre">html/semantics/text-level-semantics/the-bdo-element/</span></code>. Create a file named
<code class="docutils literal notranslate"><span class="pre">rtl.html</span></code> and open it in your text editor.</p>
<p>Here’s one way to demonstrate the feature:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>BDO element dir=rtl<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;help&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://html.spec.whatwg.org/#the-bdo-element&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;assert&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;BDO element&#39;s DIR content attribute renders corrently given value of &#39;rtl&#39;.&quot;</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Test passes if WAS is displayed below.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">bdo</span> <span class="na">dir</span><span class="o">=</span><span class="s">&quot;rtl&quot;</span><span class="p">&gt;</span>SAW<span class="p">&lt;/</span><span class="nt">bdo</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>That’s pretty dense! Let’s break it down:</p>
<ul>
<li><div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>We explicitly set the DOCTYPE and character set to be sure that browsers
don’t infer them to be something we aren’t expecting. We’re omitting the
<code class="docutils literal notranslate"><span class="pre">&lt;html&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;head&gt;</span></code> tags. That’s a common practice in WPT, preferred
because it makes tests more concise.</p>
</li>
<li><div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>BDO element dir=rtl<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>The document’s title should succinctly describe the feature under test.</p>
</li>
<li><div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;help&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://html.spec.whatwg.org/#the-bdo-element&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>The “help” metadata should reference the specification under test so that
everyone understands the motivation. This is so helpful that <a class="reference internal" href="css-metadata.html"><span class="doc">the CSS Working
Group requires it for CSS tests</span></a>! If you’re writing a reftest
for a feature outside of CSS, feel free to omit this tag.</p>
</li>
<li><div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;assert&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;BDO element&#39;s DIR content attribute renders corrently given value of &#39;rtl&#39;.&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>The “assert” metadata is a structured way for you to describe exactly what
you want your reftest to verify. For a direct test like the one we’re writing
here, it might seem a little superfluous. It’s much more helpful for
more-involved tests where reviewers might need some help understanding your
intentions.</p>
<p>This tag is optional, so you can skip it if you think it’s unnecessary. We
recommend using it for your first few tests since it may let reviewers give
you more helpful feedback. As you get more familiar with WPT and the
specifications, you’ll get a sense for when and where it’s better to leave it
out.</p>
</li>
<li><div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Test passes if WAS is displayed below.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>We’re communicating the “pass” condition in plain English to make the test
self-describing.</p>
</li>
<li><div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">bdo</span> <span class="na">dir</span><span class="o">=</span><span class="s">&quot;rtl&quot;</span><span class="p">&gt;</span>SAW<span class="p">&lt;/</span><span class="nt">bdo</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>This is the real focus of the test. We’re including some text inside a
<code class="docutils literal notranslate"><span class="pre">&lt;bdo&gt;</span></code> element in order to demonstrate the feature under test.</p>
</li>
</ul>
<p>Since this page doesn’t rely on any <a class="reference internal" href="server-features.html"><span class="doc">special WPT server
features</span></a>, we can view it by loading the HTML file directly.
There are a bunch of ways to do this; one is to navigate to the
<code class="docutils literal notranslate"><span class="pre">html/semantics/text-level-semantics/the-bdo-element/</span></code> directory in a file
browser and drag the new <code class="docutils literal notranslate"><span class="pre">rtl.html</span></code> file into an open web browser window.</p>
<p><img alt="assets/reftest-tutorial-test-screenshot.png" src="assets/reftest-tutorial-test-screenshot.png" /></p>
<p>Sighted people can open that document and verify whether or not the stated
expectation is satisfied. If we were writing a <a class="reference internal" href="manual.html"><span class="doc">manual test</span></a>, we’d be
done. However, it’s time-consuming for a human to run tests, so we should
prefer making tests automatic whenever possible. Remember that we set out to
write a “reference test.” Now it’s time to write the reference file.</p>
</div>
<div class="section" id="writing-a-match-reference">
<h2><a class="toc-backref" href="#id3">Writing a “match” reference</a><a class="headerlink" href="#writing-a-match-reference" title="Permalink to this headline">¶</a></h2>
<p>The “match” reference file describes what the test file is supposed to look
like. Critically, it <em>must not</em> use the technology that we are testing. The
reference file is what allows the test to be run by a computer–the computer
can verify that each pixel in the test document exactly matches the
corresponding pixel in the reference document.</p>
<p>Make a new file in the same
<code class="docutils literal notranslate"><span class="pre">html/semantics/text-level-semantics/the-bdo-element/</span></code> directory named
<code class="docutils literal notranslate"><span class="pre">rtl-ref.html</span></code>, and save the following markup into it:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>BDO element dir=rtl reference<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Test passes if WAS is displayed below.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>WAS<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>This is like a stripped-down version of the test file. In order to produce a
visual rendering which is the same as the expected rendering, it uses a <code class="docutils literal notranslate"><span class="pre">&lt;p&gt;</span></code>
element whose contents is the characters in right-to-left order. That way, if
the browser doesn’t support the <code class="docutils literal notranslate"><span class="pre">&lt;bdo&gt;</span></code> element, this file will still show text
in the correct sequence.</p>
<p>This file is also completely functional without the WPT server, so you can open
it in a browser directly from your hard drive.</p>
<p>Currently, there’s no way for a human operator or an automated script to know
that the two files we’ve created are supposed to match visually. We’ll need to
add one more piece of metadata to the test file we created earlier. Open
<code class="docutils literal notranslate"><span class="pre">html/semantics/text-level-semantics/the-bdo-element/rtl.html</span></code> in your text
editor and add another <code class="docutils literal notranslate"><span class="pre">&lt;link&gt;</span></code> tag as described by the following change
summary:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span> &lt;!DOCTYPE html&gt;
 &lt;meta charset=&quot;utf-8&quot;&gt;
 &lt;title&gt;BDO element dir=rtl&lt;/title&gt;
 &lt;link rel=&quot;author&quot; title=&quot;Sam Smith&quot; href=&quot;mailto:sam@example.com&quot;&gt;
 &lt;link rel=&quot;help&quot; href=&quot;https://html.spec.whatwg.org/#the-bdo-element&quot;&gt;
<span class="gi">+&lt;link rel=&quot;match&quot; href=&quot;rtl-ref.html&quot;&gt;</span>
 &lt;meta name=&quot;assert&quot; content=&quot;BDO element&#39;s DIR content attribute renders corrently given value of &#39;rtl&#39;.&quot;&gt;

 &lt;p&gt;Test passes if WAS is displayed below.&lt;/p&gt;
 &lt;bdo dir=&quot;rtl&quot;&gt;SAW&lt;/bdo&gt;
</pre></div>
</div>
<p>Now, anyone (human or computer) reviewing the test file will know where to find
the associated reference file.</p>
</div>
<div class="section" id="verifying-our-work">
<h2><a class="toc-backref" href="#id4">Verifying our work</a><a class="headerlink" href="#verifying-our-work" title="Permalink to this headline">¶</a></h2>
<p>We’re done writing the test, but we should make sure it fits in with the rest
of WPT before we submit it. This involves using some of the project’s tools, so
this is the point you’ll need to <a class="reference internal" href="../running-tests/from-local-system.html"><span class="doc">configure your system to run
WPT</span></a>.</p>
<p><a class="reference internal" href="lint-tool.html"><span class="doc">The lint tool</span></a> can detect some of the common mistakes people make
when contributing to WPT. To run it, open a command-line terminal, navigate to
the root of the WPT repository, and enter the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">./</span><span class="n">wpt</span> <span class="n">lint</span> <span class="n">html</span><span class="o">/</span><span class="n">semantics</span><span class="o">/</span><span class="n">text</span><span class="o">-</span><span class="n">level</span><span class="o">-</span><span class="n">semantics</span><span class="o">/</span><span class="n">the</span><span class="o">-</span><span class="n">bdo</span><span class="o">-</span><span class="n">element</span>
</pre></div>
</div>
<p>If this recognizes any of those common mistakes in the new files, it will tell
you where they are and how to fix them. If you do have changes to make, you can
run the command again to make sure you got them right.</p>
<p>Now, we’ll run the test using the automated pixel-by-pixel comparison approach
mentioned earlier. This is important for reftests because the test and the
reference may differ in very subtle ways that are hard to catch with the naked
eye. That’s not to say your test has to pass in all browsers (or even in <em>any</em>
browser). But if we expect the test to pass, then running it this way will help
us catch other kinds of mistakes.</p>
<p>The tools support running the tests in many different browsers. We’ll use
Firefox this time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">./</span><span class="n">wpt</span> <span class="n">run</span> <span class="n">firefox</span> <span class="n">html</span><span class="o">/</span><span class="n">semantics</span><span class="o">/</span><span class="n">text</span><span class="o">-</span><span class="n">level</span><span class="o">-</span><span class="n">semantics</span><span class="o">/</span><span class="n">the</span><span class="o">-</span><span class="n">bdo</span><span class="o">-</span><span class="n">element</span><span class="o">/</span><span class="n">rtl</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p>We expect this test to pass, so if it does, we’re ready to submit it. If we
were testing a web platform feature that Firefox didn’t support, we would
expect the test to fail instead.</p>
<p>There are a few problems to look out for in addition to passing/failing status.
The report will describe fewer tests than we expect if the test isn’t run at
all. That’s usually a sign of a formatting mistake, so you’ll want to make sure
you’ve used the right file names and metadata. Separately, the web browser
might crash. That’s often a sign of a browser bug, so you should consider
<a class="reference external" href="https://rachelandrew.co.uk/archives/2017/01/30/reporting-browser-bugs/">reporting it to the browser’s
maintainers</a>!</p>
</div>
<div class="section" id="submitting-the-test">
<h2><a class="toc-backref" href="#id5">Submitting the test</a><a class="headerlink" href="#submitting-the-test" title="Permalink to this headline">¶</a></h2>
<p>First, let’s stage the new files for committing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git add html/semantics/text-level-semantics/the-bdo-element/rtl.html
$ git add html/semantics/text-level-semantics/the-bdo-element/rtl-ref.html
</pre></div>
</div>
<p>We can make sure the commit has everything we want to submit (and nothing we
don’t) by using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git diff --staged
</pre></div>
</div>
<p>On most systems, you can use the arrow keys to navigate through the changes,
and you can press the <code class="docutils literal notranslate"><span class="pre">q</span></code> key when you’re done reviewing.</p>
<p>Next, we’ll create a commit with the staged changes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git commit -m &#39;[html] Add test for the `&lt;bdo&gt;` element&#39;
</pre></div>
</div>
<p>And now we can push the commit to our fork of WPT:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git push origin reftest-for-bdo
</pre></div>
</div>
<p>The last step is to submit the test for review. WPT doesn’t actually need the
test we wrote in this tutorial, but if we wanted to submit it for inclusion in
the repository, we would create a pull request on GitHub. <a class="reference internal" href="github-intro.html"><span class="doc">The guide on git and
GitHub</span></a> has all the details on how to do that.</p>
</div>
<div class="section" id="more-practice">
<h2><a class="toc-backref" href="#id6">More practice</a><a class="headerlink" href="#more-practice" title="Permalink to this headline">¶</a></h2>
<p>Here are some ways you can keep experimenting with WPT using this test:</p>
<ul class="simple">
<li><p>Improve coverage by adding more tests for related behaviors (e.g. nested
<code class="docutils literal notranslate"><span class="pre">&lt;bdo&gt;</span></code> elements)</p></li>
<li><p>Add another reference document which describes what the test should <em>not</em>
look like using <a class="reference internal" href="reftests.html"><span class="doc">rel=mismatch</span></a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="print-reftests.html" class="btn btn-neutral float-right" title="Print Reftests" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="reftests.html" class="btn btn-neutral float-left" title="Reftests" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>