

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Setting Up An Update Server &mdash; Firefox Source Docs  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/firefox.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.4/mermaid.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Partial Update Generation" href="partials.html" />
    <link rel="prev" title="Balrog in Release Promotion" href="balrog.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Firefox Source Docs
          

          
            
            <img src="../_static/firefox-wordmark.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Getting Set Up To Work On The Firefox Codebase</a></li>
</ul>
<p class="caption"><span class="caption-text">Working On Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Working on Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bug-mgmt/index.html">Bug Handling</a></li>
</ul>
<p class="caption"><span class="caption-text">Source Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../browser/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dom/index.html">DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../layout/index.html">Layout &amp; CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gfx/index.html">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devtools/index.html">Firefox DevTools Contributor Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toolkit/index.html">Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../js/index.html">SpiderMonkey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mobile/android/geckoview/index.html">Welcome to GeckoView’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dom/bindings/webidl/index.html">WebIDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/libpref/index.html">libpref</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remote/index.html">Remote Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/common/services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uriloader/index.html">File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../widget/cocoa/index.html">Firefox on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code-quality/index.html">Code quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writing-rust-code/index.html">Writing Rust Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/profiler/index.html">Gecko Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">The Firefox Build System</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../mach/index.html">Mach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/try/index.html">Try Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build/buildsystem/index.html">Build System</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">TaskCluster Task-Graph Generation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="taskgraph.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="mach.html">Taskcluster Mach commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="loading.html">Loading Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="transforms.html">Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimization.html">Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker-images.html">Docker Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="cron.html">Periodic Taskgraphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="try.html">Try</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="release-promotion.html">Release Promotion</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="release-promotion.html#release-promotion-phases">Release Promotion Phases</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="release-promotion.html#in-depth-relpro-guide">In-depth relpro guide</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="release-promotion-action.html">Release Promotion Action</a></li>
<li class="toctree-l4"><a class="reference internal" href="balrog.html">Balrog in Release Promotion</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Setting Up An Update Server</a></li>
<li class="toctree-l4"><a class="reference internal" href="partials.html">Partial Update Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="signing.html">Signing</a></li>
<li class="toctree-l4"><a class="reference internal" href="partner-repacks.html">Partner repacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="partner-attribution.html">Partner attribution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="versioncontrol.html">Version Control in CI</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Taskcluster Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="how-tos.html">How Tos</a></li>
<li class="toctree-l2"><a class="reference internal" href="task-graph.html">Task Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference.html">Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/moztreedocs/index.html">Managing Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Testing &amp; Test Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/testing-policy/index.html">Testing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/marionette/index.html">Marionette</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/geckodriver/index.html">geckodriver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web-platform/index.html">web-platform-tests documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/fuzzing/index.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/sanitizer/index.html">Sanitizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/perfdocs/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/code-coverage/index.html">Code coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing-rust-code/index.html">Testing &amp; Debugging Rust Code</a></li>
</ul>
<p class="caption"><span class="caption-text">Localization &amp; Internationalization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intl/index.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../l10n/index.html">Localization</a></li>
</ul>
<p class="caption"><span class="caption-text">Firefox and Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mozbase/index.html">mozbase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Using third-party Python packages</a></li>
</ul>
<p class="caption"><span class="caption-text">Metrics Collected in Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../metrics/index.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/index.html#pings">Pings</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Firefox Source Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">TaskCluster Task-Graph Generation</a> &raquo;</li>
        
          <li><a href="release-promotion.html">Release Promotion</a> &raquo;</li>
        
      <li>Setting Up An Update Server</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/taskcluster/setting-up-an-update-server.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setting-up-an-update-server">
<h1>Setting Up An Update Server<a class="headerlink" href="#setting-up-an-update-server" title="Permalink to this headline">¶</a></h1>
<p>The goal of this document is to provide instructions for installing a
locally-served Firefox update.</p>
<div class="section" id="obtaining-an-update-mar">
<h2>Obtaining an update MAR<a class="headerlink" href="#obtaining-an-update-mar" title="Permalink to this headline">¶</a></h2>
<p>Updates are served as MAR files. There are two common ways to obtain a
MAR to use: download a prebuilt one, or build one yourself.</p>
<div class="section" id="downloading-a-mar">
<h3>Downloading a MAR<a class="headerlink" href="#downloading-a-mar" title="Permalink to this headline">¶</a></h3>
<p>Prebuilt Nightly MARs can be found
<a class="reference external" href="https://archive.mozilla.org/pub/firefox/nightly/">here</a> on
archive.mozilla.org. Be sure that you use the one that matches your
machine’s configuration. For example, if you want the Nightly MAR from
2019-09-17 for a 64 bit Windows machine, you probably want the MAR
located at
<a class="reference external" href="https://archive.mozilla.org/pub/firefox/nightly/2019/09/2019-09-17-09-36-29-mozilla-central/firefox-71.0a1.en-US.win64.complete.mar">https://archive.mozilla.org/pub/firefox/nightly/2019/09/2019-09-17-09-36-29-mozilla-central/firefox-71.0a1.en-US.win64.complete.mar</a>.</p>
<p>Prebuilt MARs for release and beta can be found
<a class="reference external" href="https://archive.mozilla.org/pub/firefox/releases/">here</a>. Beta
builds are those with a <code class="docutils literal notranslate"><span class="pre">b</span></code> in the version string. After locating the
desired version, the MARs will be in the <code class="docutils literal notranslate"><span class="pre">update</span></code> directory. You want
to use the MAR labelled <code class="docutils literal notranslate"><span class="pre">complete</span></code>, not a partial MAR. Here is an
example of an appropriate MAR file to use:
<a class="reference external" href="https://archive.mozilla.org/pub/firefox/releases/69.0b9/update/win64/en-US/firefox-69.0b9.complete.mar">https://archive.mozilla.org/pub/firefox/releases/69.0b9/update/win64/en-US/firefox-69.0b9.complete.mar</a>.</p>
</div>
<div class="section" id="building-a-mar">
<h3>Building a MAR<a class="headerlink" href="#building-a-mar" title="Permalink to this headline">¶</a></h3>
<p>Building a MAR locally is more complicated. Part of the problem is that
MARs are signed by Mozilla and so you cannot really build an “official”
MAR yourself. This is a security measure designed to prevent anyone from
serving malicious updates. If you want to use a locally-built MAR, the
copy of Firefox being updated will need to be built to allow un-signed
MARs. See <a class="reference internal" href="../contributing/contribution_quickref.html#firefox-contributors-quick-reference"><span class="std std-ref">Building Firefox</span></a>
for more information on building Firefox locally. These changes will
need to be made in order to use the locally built MAR:</p>
<ul class="simple">
<li><p>Put this line in the mozconfig file in root of the build directory
(create it if it does not exist):
<code class="docutils literal notranslate"><span class="pre">ac_add_options</span> <span class="pre">--disable-verify-mar</span></code></p></li>
<li><p>Several files contain a line that must be uncommented. Open them and
find this line:
<code class="docutils literal notranslate"><span class="pre">#DEFINES['DISABLE_UPDATER_AUTHENTICODE_CHECK']</span> <span class="pre">=</span> <span class="pre">True</span></code>. Delete the
<code class="docutils literal notranslate"><span class="pre">#</span></code> at the beginning of the line to uncomment it. These are the
files that must be changed:</p>
<ul>
<li><p>toolkit/components/maintenanceservice/moz.build</p></li>
<li><p>toolkit/mozapps/update/tests/moz.build</p></li>
</ul>
</li>
</ul>
<p>Firefox should otherwise be built normally. After building, you may want
to copy the installation of Firefox elsewhere. If you update the
installation without moving it, attempts at further incremental builds
will not work properly, and a clobber will be needed when building next.
To move the installation, first call <code class="docutils literal notranslate"><span class="pre">./mach</span> <span class="pre">package</span></code>, then copy
<code class="docutils literal notranslate"><span class="pre">&lt;obj</span> <span class="pre">dir&gt;/dist/firefox</span></code> elsewhere. The copied directory will be your
install directory.</p>
<p>If you are running Windows and want the <a class="reference external" href="https://support.mozilla.org/en-US/kb/what-mozilla-maintenance-service">Mozilla Maintenance
Service</a>
to be used, there are a few additional steps to be taken here. First,
the maintenance service needs to be “installed”. Most likely, a
different maintenance service is already installed, probably at
<code class="docutils literal notranslate"><span class="pre">C:\Program</span> <span class="pre">Files</span> <span class="pre">(x86)\Mozilla</span> <span class="pre">Maintenance</span> <span class="pre">Service\maintenanceservice.exe</span></code>.
Backup that file to another location and replace it with
<code class="docutils literal notranslate"><span class="pre">&lt;obj</span> <span class="pre">dir&gt;/dist/bin/maintenanceservice.exe</span></code>. Don’t forget to restore
the backup when you are done. Next, you will need to change the
permissions on the Firefox install directory that you created. Both that
directory and its parent directory should have permissions preventing
the current user from writing to it.</p>
<p>Now that you have a build of Firefox capable of using a locally-built
MAR, it’s time to build the MAR. First, build Firefox the way you want
it to be after updating. If you want it to be the same before and after
updating, this step is unnecessary and you can use the same build that
you used to create the installation. Then run these commands,
substituting <code class="docutils literal notranslate"><span class="pre">&lt;obj</span> <span class="pre">dir&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;MAR</span> <span class="pre">output</span> <span class="pre">path&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&lt;channel&gt;</span></code> appropriately:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./mach package
$ touch <span class="s2">&quot;&lt;obj dir&gt;/dist/firefox/precomplete&quot;</span>
$ <span class="nv">MAR</span><span class="o">=</span><span class="s2">&quot;&lt;obj dir&gt;/dist/host/bin/mar.exe&quot;</span> <span class="nv">MOZ_PRODUCT_VERSION</span><span class="o">=</span>&lt;version&gt; <span class="nv">MAR_CHANNEL_ID</span><span class="o">=</span>&lt;channel&gt; ./tools/update-packaging/make_full_update.sh &lt;MAR output path&gt; <span class="s2">&quot;&lt;obj dir&gt;/dist/firefox&quot;</span>
</pre></div>
</div>
<p>For a local build, <code class="docutils literal notranslate"><span class="pre">&lt;channel&gt;</span></code> can be <code class="docutils literal notranslate"><span class="pre">default</span></code>, and <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code>
can be the value from <code class="docutils literal notranslate"><span class="pre">browser/config/version.txt</span></code> (or something
arbitrarily large like <code class="docutils literal notranslate"><span class="pre">2000.0a1</span></code>).</p>
<div class="blockindicator note docutils container">
<p>Note: It can be a bit tricky to get the <code class="docutils literal notranslate"><span class="pre">make_full_update.sh</span></code>
script to accept paths with spaces.</p>
</div>
</div>
</div>
<div class="section" id="serving-the-update">
<h2>Serving the update<a class="headerlink" href="#serving-the-update" title="Permalink to this headline">¶</a></h2>
<div class="section" id="preparing-the-update-files">
<h3>Preparing the update files<a class="headerlink" href="#preparing-the-update-files" title="Permalink to this headline">¶</a></h3>
<p>First, create the directory that updates will be served from and put the
MAR file in it. Then, create a file within called <code class="docutils literal notranslate"><span class="pre">update.xml</span></code> with
these contents, replacing <code class="docutils literal notranslate"><span class="pre">&lt;mar</span> <span class="pre">name&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;hash&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;size&gt;</span></code> with
the MAR’s filename, its sha512 hash, and its file size in bytes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;updates&gt;
    &lt;update type=&quot;minor&quot; displayVersion=&quot;2000.0a1&quot; appVersion=&quot;2000.0a1&quot; platformVersion=&quot;2000.0a1&quot; buildID=&quot;21181002100236&quot;&gt;
        &lt;patch type=&quot;complete&quot; URL=&quot;http://127.0.0.1:8000/&lt;mar name&gt;&quot; hashFunction=&quot;sha512&quot; hashValue=&quot;&lt;hash&gt;&quot; size=&quot;&lt;size&gt;&quot;/&gt;
    &lt;/update&gt;
&lt;/updates&gt;
</pre></div>
</div>
<p>If you’ve downloaded the MAR you’re using, you’ll find the sha512 value
in a file called SHA512SUMS in the root of the release directory on
archive.mozilla.org for a release or beta build (you’ll have to search
it for the file name of your MAR, since it includes the sha512 for every
file that’s part of that release), and for a nightly build you’ll find a
file with a .checksums extension adjacent to your MAR that contains that
information (for instance, for the MAR file at
<a class="reference external" href="https://archive.mozilla.org/pub/firefox/nightly/2019/09/2019-09-17-09-36-29-mozilla-central/firefox-71.0a1.en-US.win64.complete.mar">https://archive.mozilla.org/pub/firefox/nightly/2019/09/2019-09-17-09-36-29-mozilla-central/firefox-71.0a1.en-US.win64.complete.mar</a>,
the file
<a class="reference external" href="https://archive.mozilla.org/pub/firefox/nightly/2019/09/2019-09-17-09-36-29-mozilla-central/firefox-71.0a1.en-US.win64.checksums">https://archive.mozilla.org/pub/firefox/nightly/2019/09/2019-09-17-09-36-29-mozilla-central/firefox-71.0a1.en-US.win64.checksums</a>
contains the sha512 for that file as well as for all the other win64
files that are part of that nightly release).</p>
<p>If you’ve built your own MAR, you can obtain its sha512 checksum by
running the following command, which should work in Linux, macOS, or
Windows in the MozillaBuild environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shasum</span> <span class="o">--</span><span class="n">algorithm</span> <span class="mi">512</span> <span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>On Windows, you can get the exact file size in bytes for your MAR by
right clicking on it in the file explorer and selecting Properties.
You’ll find the correct size in bytes at the end of the line that begins
“Size”, <strong>not</strong> the one that begins “Size on disk”. Be sure to remove
the commas when you paste this number into the XML file.</p>
<p>On macOS, you can get the exact size of your MAR by running the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stat</span> <span class="o">-</span><span class="n">f</span><span class="o">%</span><span class="n">z</span> <span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Or on Linux, the same command would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stat</span> <span class="o">--</span><span class="nb">format</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="starting-your-update-server">
<h3>Starting your update server<a class="headerlink" href="#starting-your-update-server" title="Permalink to this headline">¶</a></h3>
<p>Now, start an update server to serve the update files on port 8000. An
easy way to do this is with Python. Remember to navigate to the correct
directory before starting the server. This is the Python2 command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python -m SimpleHTTPServer <span class="m">8000</span>
</pre></div>
</div>
<p>or, this is the Python3 command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python3 -m http.server <span class="m">8000</span>
</pre></div>
</div>
<div class="blockindicator note docutils container">
<p>If you aren’t sure that you started the server correctly, try using a
web browser to navigate to <code class="docutils literal notranslate"><span class="pre">http://127.0.0.1:8000/update.xml</span></code> and
make sure that you get the XML file you created earlier.</p>
</div>
</div>
</div>
<div class="section" id="installing-the-update">
<h2>Installing the update<a class="headerlink" href="#installing-the-update" title="Permalink to this headline">¶</a></h2>
<p>You may want to start by deleting any pending updates to ensure that no
previously found updates interfere with installing the desired update.
You can use this command with Firefox’s browser console to determine the
update directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="p">{</span><span class="n">FileUtils</span><span class="p">}</span> <span class="o">=</span> <span class="n">ChromeUtils</span><span class="o">.</span><span class="n">import</span><span class="p">(</span><span class="s2">&quot;resource://gre/modules/FileUtils.jsm&quot;</span><span class="p">);</span>
<span class="n">FileUtils</span><span class="o">.</span><span class="n">getDir</span><span class="p">(</span><span class="s2">&quot;UpdRootD&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">false</span><span class="p">)</span><span class="o">.</span><span class="n">path</span>
</pre></div>
</div>
<p>Once you have determined the update directory, close Firefox, browse to
the directory and remove the subdirectory called <code class="docutils literal notranslate"><span class="pre">updates</span></code>.</p>
<div class="line-block">
<div class="line">Next, you need to change the update URL to point to the local XML
file. This can be done most reliably with an enterprise policy. The
policy file location depends on the operating system you are using.</div>
<div class="line">Windows/Linux: <code class="docutils literal notranslate"><span class="pre">&lt;install</span> <span class="pre">dir&gt;/distribution/policies.json</span></code></div>
<div class="line">macOS: <code class="docutils literal notranslate"><span class="pre">&lt;install</span> <span class="pre">dir&gt;/Contents/Resources/distribution/policies.json</span></code></div>
<div class="line">Create the <code class="docutils literal notranslate"><span class="pre">distribution</span></code> directory, if necessary, and put this in
<code class="docutils literal notranslate"><span class="pre">policies.json</span></code>:</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;policies&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;AppUpdateURL&quot;</span><span class="p">:</span> <span class="s2">&quot;http://127.0.0.1:8000/update.xml&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now you are ready to update! Launch Firefox out of its installation
directory and navigate to the Update section <code class="docutils literal notranslate"><span class="pre">about:preferences</span></code>. You
should see it downloading the update to the update directory. Since the
transfer is entirely local this should finish quickly, and a “Restart to
Update” button should appear. Click it to restart and apply the update.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="partials.html" class="btn btn-neutral float-right" title="Partial Update Generation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="balrog.html" class="btn btn-neutral float-left" title="Balrog in Release Promotion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>