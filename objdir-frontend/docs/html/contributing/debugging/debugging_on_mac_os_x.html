

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Debugging On Mac Os X &mdash; Firefox Source Docs  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/firefox.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Debugging On Windows" href="debugging_on_windows.html" />
    <link rel="prev" title="Debugging Firefox with Valgrind" href="debugging_firefox_with_valgrind.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Firefox Source Docs
          

          
            
            <img src="../../_static/firefox-wordmark.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup/index.html">Getting Set Up To Work On The Firefox Codebase</a></li>
</ul>
<p class="caption"><span class="caption-text">Working On Firefox</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Working on Firefox</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../contribution_quickref.html">Firefox Contributors’ Quick Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pocket-guide-shipping-firefox.html">Pocket Guide: Shipping Firefox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../editor.html">Editor / IDE integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reviews.html">Getting reviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vcs/mercurial.html">Mercurial Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vcs/mercurial_bundles.html">Mercurial Bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="capturing_minidump.html">Capturing a minidump</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging_a_hang_on_os_x.html">Debugging A Hang On OS X</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging_a_minidump.html">Debugging A Minidump</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging_firefox_with_gdb.html">Debugging Firefox with GDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging_firefox_with_lldb.html">Debugging Firefox with LLDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging_firefox_with_rr.html">Debugging Firefox with rr</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging_firefox_with_valgrind.html">Debugging Firefox with Valgrind</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Debugging On Mac Os X</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-debuggable-build">Creating a debuggable build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debugging-firefox-on-macos-10-14">Debugging Firefox on macOS 10.14+</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#official-builds">Official Builds</a></li>
<li class="toctree-l4"><a class="reference internal" href="#try-server-builds">try Server Builds</a></li>
<li class="toctree-l4"><a class="reference internal" href="#local-builds">Local Builds</a></li>
<li class="toctree-l4"><a class="reference internal" href="#disabling-system-integrity-protection-sip">Disabling System Integrity Protection (SIP)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#creating-an-xcode-project">Creating an Xcode project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-lldb">Setting up lldb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#having-a-profile-for-debugging-purposes">Having a profile for debugging purposes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-a-debug-session">Running a debug session</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setting-breakpoints">Setting breakpoints</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-firefox-specific-lldb-commands">Using Firefox-specific lldb commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#debugging-e10s-child-processes">Debugging e10s child processes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#other-resources">Other resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#questions-problems">Questions? Problems?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="debugging_on_windows.html">Debugging On Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="process_dump_task_manager.html">How to get a process dump with Windows Task Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="stacktrace_report.html">How to get a stacktrace for a bug report</a></li>
<li class="toctree-l2"><a class="reference internal" href="stacktrace_windbg.html">How to get a stacktrace with WinDbg</a></li>
<li class="toctree-l2"><a class="reference internal" href="understanding_crash_reports.html">Understanding Crash Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../directory_structure.html">Firefox Source Code Directory Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build/artifact_builds.html">Understanding Artifact Builds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build/building_mobile_firefox.html">Firefox for Mobile Devices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../bug-mgmt/index.html">Bug Handling</a></li>
</ul>
<p class="caption"><span class="caption-text">Source Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../browser/index.html">Firefox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dom/index.html">DOM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../layout/index.html">Layout &amp; CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gfx/index.html">Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devtools/index.html">Firefox DevTools Contributor Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../toolkit/index.html">Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../js/index.html">SpiderMonkey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mobile/android/geckoview/index.html">Welcome to GeckoView’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dom/bindings/webidl/index.html">WebIDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/libpref/index.html">libpref</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../remote/index.html">Remote Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../services/common/services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uriloader/index.html">File Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../widget/cocoa/index.html">Firefox on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code-quality/index.html">Code quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../writing-rust-code/index.html">Writing Rust Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/profiler/index.html">Gecko Profiler</a></li>
</ul>
<p class="caption"><span class="caption-text">The Firefox Build System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../mach/index.html">Mach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/try/index.html">Try Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../build/buildsystem/index.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../taskcluster/index.html">TaskCluster Task-Graph Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/moztreedocs/index.html">Managing Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Testing &amp; Test Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../testing/testing-policy/index.html">Testing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/marionette/index.html">Marionette</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/geckodriver/index.html">geckodriver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../web-platform/index.html">web-platform-tests documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/fuzzing/index.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/sanitizer/index.html">Sanitizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/perfdocs/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/code-coverage/index.html">Code coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing-rust-code/index.html">Testing &amp; Debugging Rust Code</a></li>
</ul>
<p class="caption"><span class="caption-text">Localization &amp; Internationalization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intl/index.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../l10n/index.html">Localization</a></li>
</ul>
<p class="caption"><span class="caption-text">Firefox and Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../mozbase/index.html">mozbase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/index.html">Using third-party Python packages</a></li>
</ul>
<p class="caption"><span class="caption-text">Metrics Collected in Firefox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../metrics/index.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metrics/index.html#pings">Pings</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Firefox Source Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Working on Firefox</a> &raquo;</li>
        
      <li>Debugging On Mac Os X</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/contributing/debugging/debugging_on_mac_os_x.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="debugging-on-mac-os-x">
<h1>Debugging On Mac Os X<a class="headerlink" href="#debugging-on-mac-os-x" title="Permalink to this headline">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>This page is an import from MDN and the contents might be outdated</p></td>
</tr>
</tbody>
</table>
<p>This document explains how to debug Gecko based applications such as
Firefox, Thunderbird, and SeaMonkey on macOS using Xcode. If you want to
debug from the terminal see <a class="reference internal" href="debugging_firefox_with_lldb.html#debugging-firefox-with-lldb"><span class="std std-ref">Debugging Mozilla with
lldb</span></a>. For specific
information on a way to debug hangs, see <a class="reference internal" href="debugging_a_hang_on_os_x.html#debugging-a-hang-on-os-x"><span class="std std-ref">Debugging a hang on OS
X</span></a>.</p>
<div class="section" id="creating-a-debuggable-build">
<h2>Creating a debuggable build<a class="headerlink" href="#creating-a-debuggable-build" title="Permalink to this headline">¶</a></h2>
<p>First, you need to build the application you’re going to debug using
this in your .mozconfig</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">optimize</span>
<span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">debug</span><span class="o">-</span><span class="n">symbols</span>
</pre></div>
</div>
<p>you can also add this flag if you want assertions etc. compiled in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">debug</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../../setup/macos_build.html#building-firefox-on-macos"><span class="std std-ref">Building Firefox for macOS</span></a>
if you need help creating your own build.</p>
</div>
<div class="section" id="debugging-firefox-on-macos-10-14">
<h2>Debugging Firefox on macOS 10.14+<a class="headerlink" href="#debugging-firefox-on-macos-10-14" title="Permalink to this headline">¶</a></h2>
<p>macOS 10.14 introduced Notarization and Hardened Runtime features for
improved application security. macOS 10.15 went further, requiring
applications to be Notarized with Hardened Runtime enabled in order to
launch (ignoring workarounds.) When run on earlier macOS versions,
Notarization and Hardened Runtime settings have no effect.</p>
<div class="section" id="official-builds">
<h3>Official Builds<a class="headerlink" href="#official-builds" title="Permalink to this headline">¶</a></h3>
<p>At this time, official builds of Firefox 69 and later are Notarized.
<strong>As a result, it is not possible to attach a debugger to these official
Firefox releases on macOS 10.14+ without disabling System Integrity
Protection (SIP).</strong> This is due to Notarization requiring Hardened
Runtime to be enabled with the <code class="docutils literal notranslate"><span class="pre">com.apple.security.get-task-allow</span></code>
entitlement disallowed. <strong>Rather than disabling SIP (which has security
implications), it is recommended to debug with try builds or local
builds. The differences are explained below.</strong></p>
</div>
<div class="section" id="try-server-builds">
<h3>try Server Builds<a class="headerlink" href="#try-server-builds" title="Permalink to this headline">¶</a></h3>
<p>In most cases, developers needing to debug a build as close as possible
to the production environment should use a <a class="reference internal" href="../../tools/try/index.html#try-server"><span class="std std-ref">try
build</span></a>. These
builds enable Hardened Runtime and only differ from production builds in
that they are not Notarized which should not otherwise affect
functionality, (other than the ability to easily launch the browser on
macOS 10.15+ – see quarantine note below). At this time, developers can
obtain a Hardened Runtime build with the
<code class="docutils literal notranslate"><span class="pre">com.apple.security.get-task-allow</span></code> entitlement allowed by submitting
a try build and downloading the dmg generated by the “Rpk” shippable
build job. A debugger can be attached to Firefox processes of these
builds. try builds use the <code class="docutils literal notranslate"><span class="pre">developer.entitlements.xml</span></code> file from the
source tree while production builds use <code class="docutils literal notranslate"><span class="pre">production.entitlements.xml</span></code>.
<strong>On macOS 10.15+, downloaded try builds will not launch by default
because Notarization is required. To workaround this problem, remove the
quarantine extended attribute from the downloaded Nightly:</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">xattr</span> <span class="pre">-r</span> <span class="pre">-d</span> <span class="pre">com.apple.quarantine</span> <span class="pre">/Path/to/Nightly.app</span></code></p>
</div></blockquote>
</div>
<div class="section" id="local-builds">
<h3>Local Builds<a class="headerlink" href="#local-builds" title="Permalink to this headline">¶</a></h3>
<p>Local builds of mozilla-central do not enable Hardened Runtime and hence
do not have debugging restrictions. As a result, some functionality will
be permitted on local builds, but blocked on production builds which
have Hardened Runtime enabled. <a class="reference external" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1522409">Bug
1522409</a> was
filed to automate codesigning local builds to enable Hardened Runtime by
default and eliminate this discrepancy.</p>
<p>To obtain a Hardened Runtime build without using try infrastructure, a
developer can manually codesign builds using the macOS <code class="docutils literal notranslate"><span class="pre">codesign(1)</span></code>
command with the <code class="docutils literal notranslate"><span class="pre">developer.entitlements.xml</span></code> file from the tree. This
requires creating a codesigning identity.</p>
</div>
<div class="section" id="disabling-system-integrity-protection-sip">
<h3>Disabling System Integrity Protection (SIP)<a class="headerlink" href="#disabling-system-integrity-protection-sip" title="Permalink to this headline">¶</a></h3>
<p>If debugging a production build is required, follow Apple’s documented
steps for disabling System Integrity Protection (SIP). Note that
disabling SIP bypasses Hardened Runtime restrictions which can mask some
bugs that only occur with Hardened Runtime so it is recommended to test
fixes with SIP enabled. <strong>Disabling SIP has system security implications
that should be understood before taking this step.</strong></p>
</div>
</div>
<div class="section" id="creating-an-xcode-project">
<h2>Creating an Xcode project<a class="headerlink" href="#creating-an-xcode-project" title="Permalink to this headline">¶</a></h2>
<p>If you try to create a new Xcode project in an existing directory
then Xcode will delete its existing contents (Xcode will warn you
beforehand). To work around that, the steps below have you initialize
the project outside the Mozilla source tree, close the project, copy
the .xcodeproj project “file” into the source tree, and then reopen
the project to finish setting it up.</p>
<p>Note also that since Xcode 7.3.1 it doesn’t seem to be possible to
have the Xcode project live outside the source tree. If you try to do
that then Xcode will simply <strong>copy</strong> the source files under the
project directory rather than link to them (still the case in Xcode
10?) which breaks debugging and the possibility to
modify-rebuild-relaunch from inside Xcode.</p>
<p>These steps were last updated for Xcode 10.3:</p>
<ol class="arabic simple">
<li><p>Open Xcode, and create a new Project with File &gt; New Project. Select
the “Cross-platform” tab then under the “Other” template group select
the “Empty” project type. the click Next. Name the project and click
Next. Create/select a temporary directory to contain the project and
then click Create.</p></li>
<li><p>Before going any further, close the project (File &gt; Close Project)
and open Finder. Find the *.xcodejproj directory in the temporary
directory, move it into your Mozilla source tree, and then
double-click on it to reopen it.</p></li>
<li><p>In the left-hand pane in Xcode you should see a tree item where the
root item has the project name. If the temporary directory that you
originally created the Xcode project in is under that, right click it
and delete it. Now, right click on the root item, select ‘Add files
to “&lt;project-name&gt;”’, select all the files and directories in your
source directory, untick “Copy items if needed”, then click Add.
(These will then be progressively added under the root item
&lt;project-name&gt; in the left-hand pane. Note that subdirectories may
initially appear to be empty, but they too will progressively be
populated as Xcode processes the sourse files. Once done, you should
be able to open any file quickly by hitting Cmd-Shift-O and typing in
the name of a file.)</p></li>
<li><p>In the Product menu, select Scheme &gt; New Scheme and name your scheme
(for example, “Debug”). After you click OK, Xcode should open the
settings window for the new scheme. (If not, then open its settings
from the Product &gt; Edit Scheme menu.)</p></li>
<li><p>Select “Run” on the left-hand side of the settings window, then
select the “Info” tab. Set the Executable by clicking on “None” and
selecting “Other…”. A new dialog titled “Choose an executable to
launch” will pop up. Browse to the <code class="docutils literal notranslate"><span class="pre">.app</span></code> file that you want to
debug (<code class="docutils literal notranslate"><span class="pre">Firefox.app</span></code>, <code class="docutils literal notranslate"><span class="pre">Nightly</span></code><code class="docutils literal notranslate"><span class="pre">Debug.app</span></code> etc). The <code class="docutils literal notranslate"><span class="pre">.app</span></code>
file is typically found inside the <code class="docutils literal notranslate"><span class="pre">dist</span></code> folder in your build
directory.</p></li>
<li><p>If you are debugging Firefox, Thunderbird, or some other application
that supports multiple profiles, using a separate profile for
debugging purposes is recommended. See “Having a profile for
debugging purposes” below. Select the “Arguments” tab in the scheme
editor, and click the ‘+’ below the “Arguments passed on launch”
field. Add “-P <em>profilename</em>”, where <em>profilename</em> is the name of a
profile you created previously. Repeat that to also add the argument
“-no-remote”.</p></li>
<li><p>Also in the “Arguments” panel, you may want to add an environment
variable MOZ_DEBUG_CHILD_PROCESS set to the value 1 to help with
debugging e10s.</p></li>
<li><p>Select “Build” from the left of the scheme editor window, and check
that there is nothing listed under Targets (otherwise it may cause
problems when you try to run the executable for debugging since you
will get build errors).</p></li>
<li><p>Click “Close” to close the scheme editor.</p></li>
</ol>
<p>At this point you can run the application from Xcode, and when you pause
or hit breakpoints it should show open the correct source file at the
correct line.</p>
</div>
<div class="section" id="setting-up-lldb">
<h2>Setting up lldb<a class="headerlink" href="#setting-up-lldb" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">lldb</span></code> is the debugger XCode provides/uses.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>One important issue that the Mozilla .lldbinit file fixes is that by
default some breakpoints will be listed as “pending”, and XCode will
not stop at them. If you don’t include the Mozilla’s .lldbinit, you
must at least put
<code class="docutils literal notranslate"><span class="pre">settings</span> <span class="pre">set</span> <span class="pre">target.inline-breakpoint-strategy</span> <span class="pre">always</span></code> in your
<code class="docutils literal notranslate"><span class="pre">$HOME/.lldbinit</span></code> as recommended on <a class="reference internal" href="debugging_firefox_with_lldb.html#debugging-firefox-with-lldb"><span class="std std-ref">Debugging Firefox with
lldb</span></a>.</p>
</div>
<p>The
<a class="reference external" href="http://searchfox.org/mozilla-central/source/.lldbinit">.lldbinit</a>
file in the source tree imports many useful <a class="reference external" href="https://searchfox.org/mozilla-central/source/python/lldbutils/README.txt">Mozilla specific lldb
settings, commands and
formatters</a>
into <code class="docutils literal notranslate"><span class="pre">lldb</span></code>, but you may need to take one of the following steps to
make sure this file is used.</p>
<p>If you are using <code class="docutils literal notranslate"><span class="pre">lldb</span></code> on the command line (independently of Xcode)
and you will always run it from either the top source directory, the
object directory or else the dist/bin subdirectory of the object
directory, then adding the following setting to your <code class="docutils literal notranslate"><span class="pre">$HOME/.lldbinit</span></code>
is sufficient:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">settings</span> <span class="nb">set</span> <span class="n">target</span><span class="o">.</span><span class="n">load</span><span class="o">-</span><span class="n">cwd</span><span class="o">-</span><span class="n">lldbinit</span> <span class="n">true</span>
</pre></div>
</div>
<p><em>However</em>, if you will run lldb from a different directory, or if you
will be running it indirectly by debugging in Xcode (Xcode always runs
lldb from “/”), then this setting will not help you. Instead, add the
following to your <code class="docutils literal notranslate"><span class="pre">$HOME/.lldbinit</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This automatically sources the Mozilla project&#39;s .lldbinit as soon as lldb</span>
<span class="c1"># starts or attaches to a Mozilla app (that&#39;s in an object directory).</span>
<span class="c1">#</span>
<span class="c1"># This is mainly a workaround for Xcode not providing a way to specify that</span>
<span class="c1"># lldb should be run from a given directory.  (Xcode always runs lldb from &quot;/&quot;,</span>
<span class="c1"># regardless of what directory Xcode was started from, and regardless of the</span>
<span class="c1"># value of the &quot;Custom working directory&quot; field in the Scheme&#39;s Run options.</span>
<span class="c1"># Therefore setting `settings set target.load-cwd-lldbinit true` can&#39;t help us</span>
<span class="c1"># without Xcode providing that functionality.)</span>
<span class="c1">#</span>
<span class="c1"># The following works by setting a one-shot breakpoint to break on a function</span>
<span class="c1"># that we know will both run early (which we want when we start first start the</span>
<span class="c1"># app) and run frequently (which we want so that it will trigger ASAP if we</span>
<span class="c1"># attach to an already running app).  The breakpoint runs some commands to</span>
<span class="c1"># figure out the object directory path from the attached target and then</span>
<span class="c1"># sources the .lldbinit from there.</span>
<span class="c1">#</span>
<span class="c1"># NOTE: This scripts actions take a few seconds to complete, so the custom</span>
<span class="c1"># formatters, commands etc. that are added may not be immediately available.</span>
<span class="c1">#</span>
<span class="n">breakpoint</span> <span class="nb">set</span> <span class="o">--</span><span class="n">name</span> <span class="n">nsThread</span><span class="p">::</span><span class="n">ProcessNextEvent</span> <span class="o">--</span><span class="n">thread</span><span class="o">-</span><span class="n">index</span> <span class="mi">1</span> <span class="o">--</span><span class="n">auto</span><span class="o">-</span><span class="k">continue</span> <span class="n">true</span> <span class="o">--</span><span class="n">one</span><span class="o">-</span><span class="n">shot</span> <span class="n">true</span>
<span class="n">breakpoint</span> <span class="n">command</span> <span class="n">add</span> <span class="o">-</span><span class="n">s</span> <span class="n">python</span>
    <span class="c1"># This script that we run does not work if we try to use the global &#39;lldb&#39;</span>
    <span class="c1"># object, since it is out of date at the time that the script runs (for</span>
    <span class="c1"># example, `lldb.target.executable.fullpath` is empty).  Therefore we must</span>
    <span class="c1"># get the following objects from the &#39;frame&#39; object.</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">GetThread</span><span class="p">()</span><span class="o">.</span><span class="n">GetProcess</span><span class="p">()</span><span class="o">.</span><span class="n">GetTarget</span><span class="p">()</span>
    <span class="n">debugger</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">GetDebugger</span><span class="p">()</span>

    <span class="c1"># Delete our breakpoint (not actually necessary with `--one-shot true`):</span>
    <span class="n">target</span><span class="o">.</span><span class="n">BreakpointDelete</span><span class="p">(</span><span class="n">bp_loc</span><span class="o">.</span><span class="n">GetBreakpoint</span><span class="p">()</span><span class="o">.</span><span class="n">GetID</span><span class="p">())</span>

    <span class="c1"># For completeness, find and delete the dummy breakpoint (the breakpoint</span>
    <span class="c1"># lldb creates when it can&#39;t initially find the method to set the</span>
    <span class="c1"># breakpoint on):</span>
    <span class="c1"># BUG WORKAROUND! GetID() on the *dummy* breakpoint appears to be returning</span>
    <span class="c1"># the breakpoint index instead of its ID.  We have to add 1 to correct for</span>
    <span class="c1"># that! :-(</span>
    <span class="n">dummy_bp_list</span> <span class="o">=</span> <span class="n">lldb</span><span class="o">.</span><span class="n">SBBreakpointList</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="n">debugger</span><span class="o">.</span><span class="n">GetDummyTarget</span><span class="p">()</span><span class="o">.</span><span class="n">FindBreakpointsByName</span><span class="p">(</span><span class="s2">&quot;nsThread::ProcessNextEvent&quot;</span><span class="p">,</span> <span class="n">dummy_bp_list</span><span class="p">)</span>
    <span class="n">dummy_bp_id</span> <span class="o">=</span> <span class="n">dummy_bp_list</span><span class="o">.</span><span class="n">GetBreakpointAtIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">GetID</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">debugger</span><span class="o">.</span><span class="n">GetDummyTarget</span><span class="p">()</span><span class="o">.</span><span class="n">BreakpointDelete</span><span class="p">(</span><span class="n">dummy_bp_id</span><span class="p">)</span>

    <span class="c1"># &quot;source&quot; the Mozilla project .lldbinit:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">executable</span><span class="o">.</span><span class="n">fullpath</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/dist/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">debugger</span><span class="o">.</span><span class="n">HandleCommand</span><span class="p">(</span><span class="s2">&quot;command source -s true &quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;.lldbinit&quot;</span><span class="p">))</span>
<span class="n">DONE</span>
</pre></div>
</div>
<p>see <a class="reference internal" href="debugging_firefox_with_lldb.html#debugging-firefox-with-lldb"><span class="std std-ref">Debugging Mozilla with
lldb</span></a>. for more information.</p>
</div>
<div class="section" id="having-a-profile-for-debugging-purposes">
<h2>Having a profile for debugging purposes<a class="headerlink" href="#having-a-profile-for-debugging-purposes" title="Permalink to this headline">¶</a></h2>
<p>It is recommended to create a separate profile to debug with, whatever
your task, so that you don’t lose precious data like Bookmarks, saved
passwords, etc. So that you’re not bothered with the profile manager
every time you start to debug, expand the “Executables” branch of the
“Groups &amp; Files” list and double click on the Executable you added for
Mozilla. Click the plus icon under the “Arguments” list and type “-P
&lt;profile name&gt;” (e.g. “-P MozillaDebug”). Close the window when you’re
done.</p>
</div>
<div class="section" id="running-a-debug-session">
<h2>Running a debug session<a class="headerlink" href="#running-a-debug-session" title="Permalink to this headline">¶</a></h2>
<p>Make sure breakpoints are active (which implies running under the
debugger) by opening the Product menu and selecting “Debug / Activate
Breakpoints” (also shown by the “Breakpoints” button in the top right
section of the main window). Then click the “Run” button or select “Run”
from the Product menu.</p>
<div class="section" id="setting-breakpoints">
<h3>Setting breakpoints<a class="headerlink" href="#setting-breakpoints" title="Permalink to this headline">¶</a></h3>
<p>Setting a breakpoint is easy. Just open the source file you want to
debug in Xcode, and click in the margin to the left of the line of code
where you want to break.</p>
<p>During the debugging session, each time that line is executed, the
debugger will break there, and you will be able to debug it.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that with the default configuration, some breakpoints will be
listed as “pending”, and XCode will not stop at them. If you don’t
include the Mozilla’s .lldbinit, you must at least put
<code class="docutils literal notranslate"><span class="pre">settings</span> <span class="pre">set</span> <span class="pre">target.inline-breakpoint-strategy</span> <span class="pre">always</span></code> in your
<code class="docutils literal notranslate"><span class="pre">$HOME/.lldbinit</span></code> as recommended on <a class="reference internal" href="debugging_firefox_with_lldb.html#debugging-firefox-with-lldb"><span class="std std-ref">Debugging Mozilla with
lldb</span></a>.</p>
</div>
</div>
<div class="section" id="using-firefox-specific-lldb-commands">
<h3>Using Firefox-specific lldb commands<a class="headerlink" href="#using-firefox-specific-lldb-commands" title="Permalink to this headline">¶</a></h3>
<p>If you included the .lldbinit when <a class="reference external" href="#setting-up-lldb">Setting up
lldb</a>, you can use Mozilla-specific lldb commands
in the console, located in the Debug area of XCode. For example, type
<code class="docutils literal notranslate"><span class="pre">js</span></code> to see the JavaScript stack. For more information, see <a class="reference internal" href="debugging_firefox_with_lldb.html#debugging-firefox-with-lldb"><span class="std std-ref">Debugging
Mozilla with lldb</span></a>.</p>
</div>
<div class="section" id="debugging-e10s-child-processes">
<h3>Debugging e10s child processes<a class="headerlink" href="#debugging-e10s-child-processes" title="Permalink to this headline">¶</a></h3>
<p>Using XCode to debug child processes created by an e10s-enabled browser
is a little trickier than debugging a single-process browser, but it can
be done. These directions were written using XCode 6.3.1</p>
<ol class="arabic simple">
<li><p>Complete all the steps above under “Creating the Project”</p></li>
<li><p>From the “Product” menu, ensure the scheme you created is selected
under “Scheme”, then choose “Scheme &gt; Edit Scheme”</p></li>
<li><p>In the resulting popup, click “Duplicate Scheme”</p></li>
<li><p>Give the resulting scheme a more descriptive name than “Copy of
Scheme”</p></li>
<li><p>Select “Run” on the left-hand side of the settings window, then
select the “Info” tab. Set the Executable by clicking on the
“Executable” drop-down, and selecting the <code class="docutils literal notranslate"><span class="pre">plugin-container.app</span></code>
that is inside the app bundle of the copy of Firefox you want to
debug.</p></li>
<li><p>On the same tab, under “Launch” select “Wait for executable to be
launched”</p></li>
<li><p>On the “Arguments” tab, remove all arguments passed on launch.</p></li>
</ol>
<p>Now you’re ready to start debugging:</p>
<ol class="arabic simple">
<li><p>From the “Product” menu, ensure the scheme you created above is
selected under “Scheme”</p></li>
<li><p>Click the “Run” button. The information area at the top of the window
will show “Waiting for plugin-container to launch”</p></li>
<li><p>From a command line, run your build of Firefox. When that launches a
child process (for example, when you start to load a webpage), XCode
will notice and attach to that child process. You can then debug the
child process like you would any other process.</p></li>
<li><p>When you are done debugging, click the “Stop” button and quit the
instance of Firefox that you were debugging in the normal way.</p></li>
</ol>
<p>For some help on using lldb see <a class="reference internal" href="debugging_firefox_with_lldb.html#debugging-firefox-with-lldb"><span class="std std-ref">Debugging Mozilla with
lldb</span></a>.</p>
</div>
</div>
<div class="section" id="other-resources">
<h2>Other resources<a class="headerlink" href="#other-resources" title="Permalink to this headline">¶</a></h2>
<p>Apple has an extensive list of <a class="reference external" href="https://developer.apple.com/library/mac/#technotes/tn2124/_index.html">debugging tips and
techniques</a>.</p>
<div class="section" id="questions-problems">
<h3>Questions? Problems?<a class="headerlink" href="#questions-problems" title="Permalink to this headline">¶</a></h3>
<p>Try asking in our Element channels
<a class="reference external" href="https://chat.mozilla.org/#/room/#developers:mozilla.org">#developers</a> or
<a class="reference external" href="https://chat.mozilla.org/#/room/#macdev:mozilla.org">#macdev</a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="debugging_on_windows.html" class="btn btn-neutral float-right" title="Debugging On Windows" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="debugging_firefox_with_valgrind.html" class="btn btn-neutral float-left" title="Debugging Firefox with Valgrind" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>